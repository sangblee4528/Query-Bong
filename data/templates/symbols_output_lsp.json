[
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "CodeNavigator",
    "symbolKind": "Class",
    "startLine": 5,
    "startChar": 0,
    "endLine": 66,
    "content": "class CodeNavigator:\n    \"\"\"\n    ÏÜåÏä§ ÏΩîÎìú Ïù∏Îç±Ïä§ DBÎ•º ÌÉêÏÉâÌïòÏó¨ Ìï®Ïàò Ìò∏Ï∂ú Í≥ÑÏ∏µ Î∞è ÏòÅÌñ•ÎèÑÎ•º Î∂ÑÏÑùÌïòÎäî ÏóîÏßÄÎãàÏñ¥Ïö© ÎèÑÍµ¨.\n    \"\"\"\n    def __init__(self, db_path):\n        if not os.path.exists(db_path):\n            print(f\"[ERROR] DB ÌååÏùºÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§: {db_path}\")\n            sys.exit(1)\n        self.db_path = db_path\n\n    def print_analysis(self, target_name, mode='downstream', max_depth=5):\n        \"\"\"ÌäπÏ†ï Ïã¨Î≥ºÏùò Í≥ÑÏ∏µ Íµ¨Ï°∞Î•º ÏøºÎ¶¨ÌïòÍ≥† Ìä∏Î¶¨ ÌòïÌÉúÎ°ú Ï∂úÎ†•\"\"\"\n        target_col = \"callee_id\" if mode == 'downstream' else \"caller_id\"\n        source_col = \"caller_id\" if mode == 'downstream' else \"callee_id\"\n        \n        query = f\"\"\"\n        WITH RECURSIVE Trace(id, name, kind, path, depth, line) AS (\n            SELECT id, symbol_name, symbol_kind, file_path, 0, start_line \n            FROM source_symbols WHERE symbol_name = ?\n            UNION ALL\n            SELECT s.id, s.symbol_name, s.symbol_kind, s.file_path, t.depth + 1, s.start_line\n            FROM source_symbols s\n            JOIN symbol_relations r ON s.id = r.{target_col}\n            JOIN Trace t ON r.{source_col} = t.id\n            WHERE t.depth < ?\n        )\n        SELECT depth, name, kind, path, line FROM Trace;\n        \"\"\"\n        \n        try:\n            with sqlite3.connect(self.db_path) as conn:\n                cursor = conn.cursor()\n                cursor.execute(query, (target_name, max_depth))\n                rows = cursor.fetchall()\n\n            if not rows:\n                print(f\"\\n[ÏïåÎ¶º] '{target_name}'Ïóê ÎåÄÌïú Îç∞Ïù¥ÌÑ∞Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.\")\n                return\n\n            # ÌïúÍ∏Ä Í∞ÄÏù¥Îìú Î©òÌä∏ Î≥µÍµ¨\n            if mode == 'downstream':\n                title = \"DOWNSTREAM (ÎÇ¥Í∞Ä Î∂ÄÎ•¥Îäî Í≤ÉÎì§ - Ïã§Ìñâ ÌùêÎ¶Ñ)\"\n            else:\n                title = \"UPSTREAM (ÎÇòÎ•º Î∂ÄÎ•¥Îäî Í≤ÉÎì§ - ÏòÅÌñ•ÎèÑ Î∂ÑÏÑù)\"\n            \n            print(f\"\\n{'='*75}\")\n            print(f\" {title}: {target_name}\")\n            print(f\"{'='*75}\")\n            print(f\"{'DEPTH':<6} | {'SYMBOL TREE':<35} | {'LOCATION'}\")\n            print(\"-\" * 75)\n\n            for depth, name, kind, path, line in rows:\n                indent = \"  \" * depth\n                connector = \"L-- \" if depth > 0 else \"* \"\n                file_info = f\"{os.path.basename(path)}:{line}\"\n                kind_str = f\"({kind[0]})\" if kind else \"\"\n                \n                print(f\"D{depth:<4} | {indent}{connector}{name} {kind_str}\".ljust(45) + f\" | {file_info}\")\n            print(f\"{'='*75}\")\n\n        except Exception as e:\n            print(f\"[ERROR] Î∂ÑÏÑù Ï§ë ÏòàÏô∏ Î∞úÏÉù: {e}\")",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "__init__",
    "symbolKind": "Method",
    "startLine": 9,
    "startChar": 4,
    "endLine": 13,
    "content": "def __init__(self, db_path):\n        if not os.path.exists(db_path):\n            print(f\"[ERROR] DB ÌååÏùºÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§: {db_path}\")\n            sys.exit(1)\n        self.db_path = db_path",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "db_path",
    "symbolKind": "Kind(13)",
    "startLine": 9,
    "startChar": 23,
    "endLine": 9,
    "content": "def __init__(self, db_path):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "print_analysis",
    "symbolKind": "Method",
    "startLine": 15,
    "startChar": 4,
    "endLine": 66,
    "content": "def print_analysis(self, target_name, mode='downstream', max_depth=5):\n        \"\"\"ÌäπÏ†ï Ïã¨Î≥ºÏùò Í≥ÑÏ∏µ Íµ¨Ï°∞Î•º ÏøºÎ¶¨ÌïòÍ≥† Ìä∏Î¶¨ ÌòïÌÉúÎ°ú Ï∂úÎ†•\"\"\"\n        target_col = \"callee_id\" if mode == 'downstream' else \"caller_id\"\n        source_col = \"caller_id\" if mode == 'downstream' else \"callee_id\"\n        \n        query = f\"\"\"\n        WITH RECURSIVE Trace(id, name, kind, path, depth, line) AS (\n            SELECT id, symbol_name, symbol_kind, file_path, 0, start_line \n            FROM source_symbols WHERE symbol_name = ?\n            UNION ALL\n            SELECT s.id, s.symbol_name, s.symbol_kind, s.file_path, t.depth + 1, s.start_line\n            FROM source_symbols s\n            JOIN symbol_relations r ON s.id = r.{target_col}\n            JOIN Trace t ON r.{source_col} = t.id\n            WHERE t.depth < ?\n        )\n        SELECT depth, name, kind, path, line FROM Trace;\n        \"\"\"\n        \n        try:\n            with sqlite3.connect(self.db_path) as conn:\n                cursor = conn.cursor()\n                cursor.execute(query, (target_name, max_depth))\n                rows = cursor.fetchall()\n\n            if not rows:\n                print(f\"\\n[ÏïåÎ¶º] '{target_name}'Ïóê ÎåÄÌïú Îç∞Ïù¥ÌÑ∞Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.\")\n                return\n\n            # ÌïúÍ∏Ä Í∞ÄÏù¥Îìú Î©òÌä∏ Î≥µÍµ¨\n            if mode == 'downstream':\n                title = \"DOWNSTREAM (ÎÇ¥Í∞Ä Î∂ÄÎ•¥Îäî Í≤ÉÎì§ - Ïã§Ìñâ ÌùêÎ¶Ñ)\"\n            else:\n                title = \"UPSTREAM (ÎÇòÎ•º Î∂ÄÎ•¥Îäî Í≤ÉÎì§ - ÏòÅÌñ•ÎèÑ Î∂ÑÏÑù)\"\n            \n            print(f\"\\n{'='*75}\")\n            print(f\" {title}: {target_name}\")\n            print(f\"{'='*75}\")\n            print(f\"{'DEPTH':<6} | {'SYMBOL TREE':<35} | {'LOCATION'}\")\n            print(\"-\" * 75)\n\n            for depth, name, kind, path, line in rows:\n                indent = \"  \" * depth\n                connector = \"L-- \" if depth > 0 else \"* \"\n                file_info = f\"{os.path.basename(path)}:{line}\"\n                kind_str = f\"({kind[0]})\" if kind else \"\"\n                \n                print(f\"D{depth:<4} | {indent}{connector}{name} {kind_str}\".ljust(45) + f\" | {file_info}\")\n            print(f\"{'='*75}\")\n\n        except Exception as e:\n            print(f\"[ERROR] Î∂ÑÏÑù Ï§ë ÏòàÏô∏ Î∞úÏÉù: {e}\")",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/tools/code_navigator.py",
        "startLine": 93
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "target_name",
    "symbolKind": "Kind(13)",
    "startLine": 15,
    "startChar": 29,
    "endLine": 15,
    "content": "def print_analysis(self, target_name, mode='downstream', max_depth=5):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "mode",
    "symbolKind": "Kind(13)",
    "startLine": 15,
    "startChar": 42,
    "endLine": 15,
    "content": "def print_analysis(self, target_name, mode='downstream', max_depth=5):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "max_depth",
    "symbolKind": "Kind(13)",
    "startLine": 15,
    "startChar": 61,
    "endLine": 15,
    "content": "def print_analysis(self, target_name, mode='downstream', max_depth=5):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "target_col",
    "symbolKind": "Kind(13)",
    "startLine": 17,
    "startChar": 8,
    "endLine": 17,
    "content": "target_col = \"callee_id\" if mode == 'downstream' else \"caller_id\"",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "source_col",
    "symbolKind": "Kind(13)",
    "startLine": 18,
    "startChar": 8,
    "endLine": 18,
    "content": "source_col = \"caller_id\" if mode == 'downstream' else \"callee_id\"",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "query",
    "symbolKind": "Kind(13)",
    "startLine": 20,
    "startChar": 8,
    "endLine": 20,
    "content": "query = f\"\"\"",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "conn",
    "symbolKind": "Kind(13)",
    "startLine": 35,
    "startChar": 50,
    "endLine": 35,
    "content": "with sqlite3.connect(self.db_path) as conn:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "cursor",
    "symbolKind": "Kind(13)",
    "startLine": 36,
    "startChar": 16,
    "endLine": 36,
    "content": "cursor = conn.cursor()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "rows",
    "symbolKind": "Kind(13)",
    "startLine": 38,
    "startChar": 16,
    "endLine": 38,
    "content": "rows = cursor.fetchall()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "title",
    "symbolKind": "Kind(13)",
    "startLine": 46,
    "startChar": 16,
    "endLine": 46,
    "content": "title = \"DOWNSTREAM (ÎÇ¥Í∞Ä Î∂ÄÎ•¥Îäî Í≤ÉÎì§ - Ïã§Ìñâ ÌùêÎ¶Ñ)\"",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "depth",
    "symbolKind": "Kind(13)",
    "startLine": 56,
    "startChar": 16,
    "endLine": 56,
    "content": "for depth, name, kind, path, line in rows:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "name",
    "symbolKind": "Kind(13)",
    "startLine": 56,
    "startChar": 23,
    "endLine": 56,
    "content": "for depth, name, kind, path, line in rows:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "kind",
    "symbolKind": "Kind(13)",
    "startLine": 56,
    "startChar": 29,
    "endLine": 56,
    "content": "for depth, name, kind, path, line in rows:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "path",
    "symbolKind": "Kind(13)",
    "startLine": 56,
    "startChar": 35,
    "endLine": 56,
    "content": "for depth, name, kind, path, line in rows:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "line",
    "symbolKind": "Kind(13)",
    "startLine": 56,
    "startChar": 41,
    "endLine": 56,
    "content": "for depth, name, kind, path, line in rows:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "indent",
    "symbolKind": "Kind(13)",
    "startLine": 57,
    "startChar": 16,
    "endLine": 57,
    "content": "indent = \"  \" * depth",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "connector",
    "symbolKind": "Kind(13)",
    "startLine": 58,
    "startChar": 16,
    "endLine": 58,
    "content": "connector = \"L-- \" if depth > 0 else \"* \"",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "file_info",
    "symbolKind": "Kind(13)",
    "startLine": 59,
    "startChar": 16,
    "endLine": 59,
    "content": "file_info = f\"{os.path.basename(path)}:{line}\"",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "kind_str",
    "symbolKind": "Kind(13)",
    "startLine": 60,
    "startChar": 16,
    "endLine": 60,
    "content": "kind_str = f\"({kind[0]})\" if kind else \"\"",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "e",
    "symbolKind": "Kind(13)",
    "startLine": 65,
    "startChar": 28,
    "endLine": 65,
    "content": "except Exception as e:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "db_path",
    "symbolKind": "Kind(13)",
    "startLine": 13,
    "startChar": 13,
    "endLine": 13,
    "content": "self.db_path = db_path",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "main",
    "symbolKind": "Function",
    "startLine": 68,
    "startChar": 0,
    "endLine": 99,
    "content": "def main():\n    current_dir = os.path.dirname(os.path.abspath(__file__))\n    project_root = os.path.dirname(current_dir)\n    db_path = os.path.join(project_root, \"data\", \"source_code_index_01.db\")\n\n    nav = CodeNavigator(db_path)\n\n    print(\"\\n\" + \"#\"*60)\n    print(\"  BONG-AI CODE NAVIGATOR v1.2 (System Engineering Edition)\")\n    print(\"  - Ï¢ÖÎ£åÌïòÎ†§Î©¥ 'q', 'quit', 'exit'Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî.\")\n    print(\"#\"*60)\n\n    while True:\n        try:\n            print(\"\\n\" + \"-\"*60)\n            target = input(\"Î∂ÑÏÑùÌï† Ïã¨Î≥º Ïù¥Î¶Ñ ÏûÖÎ†• > \").strip()\n            \n            if not target or target.lower() in ['q', 'quit', 'exit']:\n                print(\"\\n[INFO] ÎÇ¥ÎπÑÍ≤åÏù¥ÌÑ∞Î•º Ï¢ÖÎ£åÌï©ÎãàÎã§.\")\n                break\n\n            print(\" [1] Downstream (ÎÇ¥Í∞Ä Î∂ÄÎ•¥Îäî Í≤ÉÎì§)  [2] Upstream (ÎÇòÎ•º Î∂ÄÎ•¥Îäî Í≤ÉÎì§)\")\n            choice = input(\" ÏÑ†ÌÉù (Í∏∞Î≥∏ 1) > \").strip()\n\n            mode = 'upstream' if choice == '2' else 'downstream'\n            nav.print_analysis(target, mode=mode)\n\n        except KeyboardInterrupt:\n            print(\"\\n\\n[INFO] ÌîÑÎ°úÍ∑∏Îû®Ïù¥ Ï§ëÎã®ÎêòÏóàÏäµÎãàÎã§.\")\n            break\n        except Exception as e:\n            print(f\"[ERROR] Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: {e}\")",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/tools/code_navigator.py",
        "startLine": 102
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "current_dir",
    "symbolKind": "Kind(13)",
    "startLine": 69,
    "startChar": 4,
    "endLine": 69,
    "content": "current_dir = os.path.dirname(os.path.abspath(__file__))",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "project_root",
    "symbolKind": "Kind(13)",
    "startLine": 70,
    "startChar": 4,
    "endLine": 70,
    "content": "project_root = os.path.dirname(current_dir)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "db_path",
    "symbolKind": "Kind(13)",
    "startLine": 71,
    "startChar": 4,
    "endLine": 71,
    "content": "db_path = os.path.join(project_root, \"data\", \"source_code_index_01.db\")",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "nav",
    "symbolKind": "Kind(13)",
    "startLine": 73,
    "startChar": 4,
    "endLine": 73,
    "content": "nav = CodeNavigator(db_path)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "target",
    "symbolKind": "Kind(13)",
    "startLine": 83,
    "startChar": 12,
    "endLine": 83,
    "content": "target = input(\"Î∂ÑÏÑùÌï† Ïã¨Î≥º Ïù¥Î¶Ñ ÏûÖÎ†• > \").strip()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "choice",
    "symbolKind": "Kind(13)",
    "startLine": 90,
    "startChar": 12,
    "endLine": 90,
    "content": "choice = input(\" ÏÑ†ÌÉù (Í∏∞Î≥∏ 1) > \").strip()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "mode",
    "symbolKind": "Kind(13)",
    "startLine": 92,
    "startChar": 12,
    "endLine": 92,
    "content": "mode = 'upstream' if choice == '2' else 'downstream'",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/tools/code_navigator.py",
    "symbolName": "e",
    "symbolKind": "Kind(13)",
    "startLine": 98,
    "startChar": 28,
    "endLine": 98,
    "content": "except Exception as e:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "SourceIndexerDB",
    "symbolKind": "Class",
    "startLine": 6,
    "startChar": 0,
    "endLine": 175,
    "content": "class SourceIndexerDB:\n    \"\"\"\n    LSP(Language Server Protocol)ÏóêÏÑú Ï∂îÏ∂úÎêú Ïã¨Î≥º Îç∞Ïù¥ÌÑ∞Î•º \n    Í¥ÄÍ≥ÑÌòï Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§(SQLite)Î°ú ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖòÌïòÏó¨ ÏÜåÏä§ ÏΩîÎìú ÏßÄÏãù Í∑∏ÎûòÌîÑÎ•º Íµ¨Ï∂ïÌïòÎäî ÌÅ¥ÎûòÏä§.\n    \"\"\"\n    def __init__(self, db_name=\"source_code_index.db\"):\n        \"\"\"\n        ÏãúÏä§ÌÖú ÌôòÍ≤Ω ÏÑ§Ï†ï Î∞è Îç∞Ïù¥ÌÑ∞ Í≤ΩÎ°ú Ï¥àÍ∏∞Ìôî.\n        ÌîÑÎ°úÏ†ùÌä∏ Î£®Ìä∏Î•º Í∏∞Ï§ÄÏúºÎ°ú ÏÉÅÎåÄ Í≤ΩÎ°úÎ•º Ï†àÎåÄ Í≤ΩÎ°úÎ°ú Î≥ÄÌôòÌïòÏó¨ ÌôòÍ≤Ω ÎèÖÎ¶ΩÏÑ± ÌôïÎ≥¥.\n        \"\"\"\n        # Ïä§ÌÅ¨Î¶ΩÌä∏ ÏúÑÏπò Í∏∞Ï§Ä ÏÉÅÏúÑ Ìè¥Îçî Íµ¨Ï°∞ Ï†ïÏùò (ÌîÑÎ°úÏ†ùÌä∏ ÌëúÏ§Ä Î†àÏù¥ÏïÑÏõÉ Ï§ÄÏàò)\n        self.project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))\n        self.data_dir = os.path.join(self.project_root, \"data\")\n        self.db_path = os.path.join(self.data_dir, db_name)\n        self.json_path = os.path.join(self.data_dir, \"symbols_output_lsp.json\")\n\n    def create_tables(self):\n        \"\"\"\n        [Schema Design] \n        Îç∞Ïù¥ÌÑ∞ Î¨¥Í≤∞ÏÑ±Í≥º Í≤ÄÏÉâ ÏÜçÎèÑÎ•º Í≥†Î†§ÌïòÏó¨ Node(Ïã¨Î≥º)ÏôÄ Edge(Í¥ÄÍ≥Ñ) ÌÖåÏù¥Î∏î Î∂ÑÎ¶¨ ÏÑ§Í≥Ñ.\n        \"\"\"\n        conn = sqlite3.connect(self.db_path)\n        cursor = conn.cursor()\n        \n        # Î©±Îì±ÏÑ±(Idempotency) Î≥¥Ïû•ÏùÑ ÏúÑÌï¥ Í∏∞Ï°¥ ÌÖåÏù¥Î∏î ÏÇ≠Ï†ú ÌõÑ Ïû¨ÏÉùÏÑ± (Clean Build)\n        cursor.execute(\"DROP TABLE IF EXISTS symbol_relations\")\n        cursor.execute(\"DROP TABLE IF EXISTS source_symbols\")\n        \n        # 1. source_symbols: ÏΩîÎìúÏùò ÏµúÏÜå Îã®ÏúÑ(Ìï®Ïàò, ÌÅ¥ÎûòÏä§ Îì±)Î•º Ï†ÄÏû•ÌïòÎäî ÎßàÏä§ÌÑ∞ ÌÖåÏù¥Î∏î\n        cursor.execute(\"\"\"\n            CREATE TABLE source_symbols (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                file_path TEXT,          -- ÏÜåÏä§ ÌååÏùº Ï†ÑÏ≤¥ Í≤ΩÎ°ú\n                symbol_name TEXT,        -- Ïã¨Î≥º Ïù¥Î¶Ñ (Ïòà: function_name)\n                symbol_kind TEXT,        -- Ï¢ÖÎ•ò (Class, Method, Function Îì±)\n                start_line INTEGER,      -- ÏÜåÏä§ ÎÇ¥ ÏãúÏûë ÎùºÏù∏ (1-based)\n                end_line INTEGER,        -- ÏÜåÏä§ ÎÇ¥ Ï¢ÖÎ£å ÎùºÏù∏\n                content TEXT             -- Ïã§Ï†ú ÏÜåÏä§ ÏΩîÎìú Ï°∞Í∞Å (Snippet)\n            )\n        \"\"\")\n        \n        # 2. symbol_relations: Ïã¨Î≥º Í∞ÑÏùò Ìò∏Ï∂ú Í¥ÄÍ≥ÑÎ•º Ï∂îÏ†ÅÌïòÎäî Ïù∏Ï†ë Î¶¨Ïä§Ìä∏(Adjacency List)\n        cursor.execute(\"\"\"\n            CREATE TABLE symbol_relations (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                caller_id INTEGER,       -- Ìò∏Ï∂ú Ï£ºÏ≤¥ (ÎàÑÍ∞Ä)\n                callee_id INTEGER,       -- Ìò∏Ï∂ú ÎåÄÏÉÅ (ÎàÑÍµ¨Î•º)\n                relation_type TEXT DEFAULT 'CALLS',\n                FOREIGN KEY(caller_id) REFERENCES source_symbols(id),\n                FOREIGN KEY(callee_id) REFERENCES source_symbols(id)\n            )\n        \"\"\")\n        \n        # [Performance] ÎåÄÍ∑úÎ™® ÏΩîÎìúÎ≤†Ïù¥Ïä§ Î∂ÑÏÑù Ïãú Ï°∞Ïù∏(Join) ÏÑ±Îä•ÏùÑ ÏúÑÌïú Î≥µÌï© Ïù∏Îç±Ïä§ ÏÑ§Ï†ï\n        cursor.execute(\"CREATE INDEX idx_symbol_name ON source_symbols(symbol_name)\")\n        cursor.execute(\"CREATE INDEX idx_file_range ON source_symbols(file_path, start_line, end_line)\")\n        \n        conn.commit()\n        conn.close()\n        print(f\"‚úÖ DB Ïä§ÌÇ§Îßà ÏÉùÏÑ± ÏôÑÎ£å: {self.db_path}\")\n\n    def clean_path(self, path):\n        \"\"\"\n        LSP ÏÑúÎ≤ÑÍ∞Ä Î∞òÌôòÌïòÎäî URI ÌòïÌÉú(file:///...)Î•º Î°úÏª¨ OS ÌëúÏ§Ä Í≤ΩÎ°úÎ°ú Ï†ïÍ∑úÌôî.\n        OSÎ≥Ñ Í≤ΩÎ°ú Íµ¨Î∂ÑÏûê(Backslash vs Slash) Ï∞®Ïù¥ Ìï¥Í≤∞.\n        \"\"\"\n        if not path: return \"\"\n        # URI Ï†ëÎëêÏñ¥ Ï†úÍ±∞ Î∞è ÌëúÏ§ÄÌôîÎêú OS Í≤ΩÎ°úÎ°ú Î≥ÄÌôò\n        path = re.sub(r'^file:[\\\\/]+', '', path)\n        return os.path.normpath(path)\n\n    def migrate_data(self):\n        \"\"\"\n        [Core Logic] JSON Îç∞Ïù¥ÌÑ∞Î•º ÌååÏã±ÌïòÏó¨ Í¥ÄÍ≥ÑÌòï DBÎ°ú ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò.\n        Îëê Îã®Í≥Ñ(Phase)Î•º ÌÜµÌï¥ Îç∞Ïù¥ÌÑ∞Ïùò ÏùºÍ¥ÄÏÑ±ÏùÑ ÌôïÎ≥¥Ìï®.\n        \"\"\"\n        if not os.path.exists(self.json_path):\n            print(f\"‚ùå ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò Ïã§Ìå®: {self.json_path} ÌååÏùºÏù¥ Ï°¥Ïû¨ÌïòÏßÄ ÏïäÏäµÎãàÎã§.\")\n            return\n\n        with open(self.json_path, 'r', encoding='utf-8') as f:\n            data = json.load(f)\n\n        conn = sqlite3.connect(self.db_path)\n        cursor = conn.cursor()\n\n        # [Phase 1] ÎÖ∏Îìú Îç∞Ïù¥ÌÑ∞ ÏÇΩÏûÖ: Î™®Îì† Ïã¨Î≥ºÏùÑ Î®ºÏ†Ä DBÏóê Ï†ÅÏû¨ÌïòÏó¨ Í≥†Ïú† ID Ìï†Îãπ\n        print(f\"üöÄ [Phase 1] Ïã¨Î≥º ÎßàÏä§ÌÑ∞ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Ï§ë: {len(data)} Í±¥\")\n        for item in data:\n            cursor.execute(\"\"\"\n                INSERT INTO source_symbols (file_path, symbol_name, symbol_kind, start_line, end_line, content) \n                VALUES (?, ?, ?, ?, ?, ?)\n            \"\"\", (\n                self.clean_path(item['filePath']),\n                item['symbolName'],\n                item['symbolKind'],\n                item['startLine'],\n                item['endLine'],\n                item['content']\n            ))\n        conn.commit()\n\n        # [Phase 2] ÏóêÏßÄ Îç∞Ïù¥ÌÑ∞ Îß§Ìïë: Ï∞∏Ï°∞(References) Ï†ïÎ≥¥Î•º Î∂ÑÏÑùÌïòÏó¨ Ìò∏Ï∂ú Í¥ÄÍ≥Ñ Íµ¨Ï∂ï\n        print(\"üöÄ [Phase 2] Ïã¨Î≥º Í∞Ñ Ìò∏Ï∂ú Í¥ÄÍ≥Ñ(Graph Edge) Îß§Ìïë Ï§ë...\")\n        for callee_data in data:\n            # ÌîºÌò∏Ï∂úÏûê(Callee)Ïùò DB ID Ï°∞Ìöå\n            cursor.execute(\"\"\"\n                SELECT id FROM source_symbols \n                WHERE file_path = ? AND start_line = ? AND symbol_name = ?\n            \"\"\", (self.clean_path(callee_data['filePath']), callee_data['startLine'], callee_data['symbolName']))\n            row = cursor.fetchone()\n            if not row: continue\n            callee_id = row[0]\n\n            # Ïù¥ Ïã¨Î≥ºÏùÑ Ìò∏Ï∂úÌïòÎäî Î™®Îì† ÏßÄÏ†ê(references)ÏùÑ ÏàúÌöåÌïòÎ©∞ Caller ÏãùÎ≥Ñ\n            for ref in callee_data.get('references', []):\n                ref_path = self.clean_path(ref['refPath'])\n                ref_line = ref['startLine']\n\n                # Ìò∏Ï∂úÏù¥ Î∞úÏÉùÌïú ÎùºÏù∏ Î≤àÌò∏Î•º Î≤îÏúÑ(start_line ~ end_line)Î°ú Ìè¨Ìï®ÌïòÎäî Ìï®Ïàò/Î©îÏÑúÎìú ÌÉêÏÉâ\n                # Í∞ÄÏû• ÏûëÏùÄ Î≤îÏúÑ(Ìï®Ïàò)Í∞Ä CallerÍ∞Ä ÎêòÎèÑÎ°ù Ï†ïÎ†¨ Ï°∞Í±¥ Ï∂îÍ∞Ä\n                cursor.execute(\"\"\"\n                    SELECT id FROM source_symbols \n                    WHERE file_path = ? \n                      AND ? BETWEEN start_line AND end_line\n                      AND symbol_kind IN ('Method', 'Function', 'Class')\n                    ORDER BY (end_line - start_line) ASC\n                    LIMIT 1\n                \"\"\", (ref_path, ref_line))\n                \n                caller_row = cursor.fetchone()\n                if caller_row:\n                    caller_id = caller_row[0]\n                    # Ï§ëÎ≥µ Í¥ÄÍ≥Ñ Î∞©ÏßÄÎ•º ÏúÑÌï¥ Ïã†Ï§ëÌûà Ïù∏ÏÑúÌä∏ (ÌïÑÏöî Ïãú INSERT OR IGNORE Í∞ÄÎä•)\n                    cursor.execute(\"INSERT INTO symbol_relations (caller_id, callee_id) VALUES (?, ?)\", \n                                   (caller_id, callee_id))\n\n        conn.commit()\n        conn.close()\n        print(f\"‚ú® ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò ÏµúÏ¢Ö ÏôÑÎ£å.\")\n\n    def verify_db(self):\n        \"\"\"\n        Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• ÌõÑ Ï†ïÌï©ÏÑ± Í≤ÄÏ¶ùÏùÑ ÏúÑÌïú ÏÉÅÌÉú Î¶¨Ìè¨Ìä∏ Ï∂úÎ†•.\n        ÏÑ±Í≥µÏ†ÅÏù∏ ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò Ïó¨Î∂ÄÎ•º ÌåêÎã®ÌïòÎäî ÎîîÎ≤ÑÍπÖ ÎèÑÍµ¨.\n        \"\"\"\n        conn = sqlite3.connect(self.db_path)\n        cursor = conn.cursor()\n        \n        print(\"\\nüìä [DB Î¨¥Í≤∞ÏÑ± Í≤ÄÏ¶ù Î¶¨Ìè¨Ìä∏]\")\n        # Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞ Í∞úÏàò ÌôïÏù∏\n        cursor.execute(\"SELECT COUNT(*) FROM source_symbols\")\n        print(f\" - Ï¥ù Ïã¨Î≥º(Node) Ïàò: {cursor.fetchone()[0]}Í∞ú\")\n        \n        cursor.execute(\"SELECT COUNT(*) FROM symbol_relations\")\n        print(f\" - Ï¥ù Ìò∏Ï∂ú Í¥ÄÍ≥Ñ(Edge) Ïàò: {cursor.fetchone()[0]}Í∞ú\")\n        \n        # Í¥ÄÍ≥Ñ Îß§Ìïë Í≤∞Í≥º ÏÉòÌîåÎßÅ (Top 3)\n        print(\"\\nüîó [Ìò∏Ï∂ú Í∑∏ÎûòÌîÑ Ïó∞Í≤∞ÏÑ± ÌôïÏù∏ ÏÉòÌîå]\")\n        cursor.execute(\"\"\"\n            SELECT caller.symbol_name, callee.symbol_name \n            FROM symbol_relations r\n            JOIN source_symbols caller ON r.caller_id = caller.id\n            JOIN source_symbols callee ON r.callee_id = callee.id\n            LIMIT 3\n        \"\"\")\n        for row in cursor.fetchall():\n            print(f\"   [Caller] {row[0]} -> [Callee] {row[1]}\")\n            \n        conn.close()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "__init__",
    "symbolKind": "Method",
    "startLine": 11,
    "startChar": 4,
    "endLine": 20,
    "content": "def __init__(self, db_name=\"source_code_index.db\"):\n        \"\"\"\n        ÏãúÏä§ÌÖú ÌôòÍ≤Ω ÏÑ§Ï†ï Î∞è Îç∞Ïù¥ÌÑ∞ Í≤ΩÎ°ú Ï¥àÍ∏∞Ìôî.\n        ÌîÑÎ°úÏ†ùÌä∏ Î£®Ìä∏Î•º Í∏∞Ï§ÄÏúºÎ°ú ÏÉÅÎåÄ Í≤ΩÎ°úÎ•º Ï†àÎåÄ Í≤ΩÎ°úÎ°ú Î≥ÄÌôòÌïòÏó¨ ÌôòÍ≤Ω ÎèÖÎ¶ΩÏÑ± ÌôïÎ≥¥.\n        \"\"\"\n        # Ïä§ÌÅ¨Î¶ΩÌä∏ ÏúÑÏπò Í∏∞Ï§Ä ÏÉÅÏúÑ Ìè¥Îçî Íµ¨Ï°∞ Ï†ïÏùò (ÌîÑÎ°úÏ†ùÌä∏ ÌëúÏ§Ä Î†àÏù¥ÏïÑÏõÉ Ï§ÄÏàò)\n        self.project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))\n        self.data_dir = os.path.join(self.project_root, \"data\")\n        self.db_path = os.path.join(self.data_dir, db_name)\n        self.json_path = os.path.join(self.data_dir, \"symbols_output_lsp.json\")",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "db_name",
    "symbolKind": "Kind(13)",
    "startLine": 11,
    "startChar": 23,
    "endLine": 11,
    "content": "def __init__(self, db_name=\"source_code_index.db\"):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "create_tables",
    "symbolKind": "Method",
    "startLine": 22,
    "startChar": 4,
    "endLine": 65,
    "content": "def create_tables(self):\n        \"\"\"\n        [Schema Design] \n        Îç∞Ïù¥ÌÑ∞ Î¨¥Í≤∞ÏÑ±Í≥º Í≤ÄÏÉâ ÏÜçÎèÑÎ•º Í≥†Î†§ÌïòÏó¨ Node(Ïã¨Î≥º)ÏôÄ Edge(Í¥ÄÍ≥Ñ) ÌÖåÏù¥Î∏î Î∂ÑÎ¶¨ ÏÑ§Í≥Ñ.\n        \"\"\"\n        conn = sqlite3.connect(self.db_path)\n        cursor = conn.cursor()\n        \n        # Î©±Îì±ÏÑ±(Idempotency) Î≥¥Ïû•ÏùÑ ÏúÑÌï¥ Í∏∞Ï°¥ ÌÖåÏù¥Î∏î ÏÇ≠Ï†ú ÌõÑ Ïû¨ÏÉùÏÑ± (Clean Build)\n        cursor.execute(\"DROP TABLE IF EXISTS symbol_relations\")\n        cursor.execute(\"DROP TABLE IF EXISTS source_symbols\")\n        \n        # 1. source_symbols: ÏΩîÎìúÏùò ÏµúÏÜå Îã®ÏúÑ(Ìï®Ïàò, ÌÅ¥ÎûòÏä§ Îì±)Î•º Ï†ÄÏû•ÌïòÎäî ÎßàÏä§ÌÑ∞ ÌÖåÏù¥Î∏î\n        cursor.execute(\"\"\"\n            CREATE TABLE source_symbols (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                file_path TEXT,          -- ÏÜåÏä§ ÌååÏùº Ï†ÑÏ≤¥ Í≤ΩÎ°ú\n                symbol_name TEXT,        -- Ïã¨Î≥º Ïù¥Î¶Ñ (Ïòà: function_name)\n                symbol_kind TEXT,        -- Ï¢ÖÎ•ò (Class, Method, Function Îì±)\n                start_line INTEGER,      -- ÏÜåÏä§ ÎÇ¥ ÏãúÏûë ÎùºÏù∏ (1-based)\n                end_line INTEGER,        -- ÏÜåÏä§ ÎÇ¥ Ï¢ÖÎ£å ÎùºÏù∏\n                content TEXT             -- Ïã§Ï†ú ÏÜåÏä§ ÏΩîÎìú Ï°∞Í∞Å (Snippet)\n            )\n        \"\"\")\n        \n        # 2. symbol_relations: Ïã¨Î≥º Í∞ÑÏùò Ìò∏Ï∂ú Í¥ÄÍ≥ÑÎ•º Ï∂îÏ†ÅÌïòÎäî Ïù∏Ï†ë Î¶¨Ïä§Ìä∏(Adjacency List)\n        cursor.execute(\"\"\"\n            CREATE TABLE symbol_relations (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                caller_id INTEGER,       -- Ìò∏Ï∂ú Ï£ºÏ≤¥ (ÎàÑÍ∞Ä)\n                callee_id INTEGER,       -- Ìò∏Ï∂ú ÎåÄÏÉÅ (ÎàÑÍµ¨Î•º)\n                relation_type TEXT DEFAULT 'CALLS',\n                FOREIGN KEY(caller_id) REFERENCES source_symbols(id),\n                FOREIGN KEY(callee_id) REFERENCES source_symbols(id)\n            )\n        \"\"\")\n        \n        # [Performance] ÎåÄÍ∑úÎ™® ÏΩîÎìúÎ≤†Ïù¥Ïä§ Î∂ÑÏÑù Ïãú Ï°∞Ïù∏(Join) ÏÑ±Îä•ÏùÑ ÏúÑÌïú Î≥µÌï© Ïù∏Îç±Ïä§ ÏÑ§Ï†ï\n        cursor.execute(\"CREATE INDEX idx_symbol_name ON source_symbols(symbol_name)\")\n        cursor.execute(\"CREATE INDEX idx_file_range ON source_symbols(file_path, start_line, end_line)\")\n        \n        conn.commit()\n        conn.close()\n        print(f\"‚úÖ DB Ïä§ÌÇ§Îßà ÏÉùÏÑ± ÏôÑÎ£å: {self.db_path}\")",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
        "startLine": 180
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "conn",
    "symbolKind": "Kind(13)",
    "startLine": 27,
    "startChar": 8,
    "endLine": 27,
    "content": "conn = sqlite3.connect(self.db_path)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "cursor",
    "symbolKind": "Kind(13)",
    "startLine": 28,
    "startChar": 8,
    "endLine": 28,
    "content": "cursor = conn.cursor()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "clean_path",
    "symbolKind": "Method",
    "startLine": 67,
    "startChar": 4,
    "endLine": 75,
    "content": "def clean_path(self, path):\n        \"\"\"\n        LSP ÏÑúÎ≤ÑÍ∞Ä Î∞òÌôòÌïòÎäî URI ÌòïÌÉú(file:///...)Î•º Î°úÏª¨ OS ÌëúÏ§Ä Í≤ΩÎ°úÎ°ú Ï†ïÍ∑úÌôî.\n        OSÎ≥Ñ Í≤ΩÎ°ú Íµ¨Î∂ÑÏûê(Backslash vs Slash) Ï∞®Ïù¥ Ìï¥Í≤∞.\n        \"\"\"\n        if not path: return \"\"\n        # URI Ï†ëÎëêÏñ¥ Ï†úÍ±∞ Î∞è ÌëúÏ§ÄÌôîÎêú OS Í≤ΩÎ°úÎ°ú Î≥ÄÌôò\n        path = re.sub(r'^file:[\\\\/]+', '', path)\n        return os.path.normpath(path)",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
        "startLine": 99
      },
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
        "startLine": 115
      },
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
        "startLine": 122
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "path",
    "symbolKind": "Kind(13)",
    "startLine": 67,
    "startChar": 25,
    "endLine": 67,
    "content": "def clean_path(self, path):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "migrate_data",
    "symbolKind": "Method",
    "startLine": 77,
    "startChar": 4,
    "endLine": 145,
    "content": "def migrate_data(self):\n        \"\"\"\n        [Core Logic] JSON Îç∞Ïù¥ÌÑ∞Î•º ÌååÏã±ÌïòÏó¨ Í¥ÄÍ≥ÑÌòï DBÎ°ú ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò.\n        Îëê Îã®Í≥Ñ(Phase)Î•º ÌÜµÌï¥ Îç∞Ïù¥ÌÑ∞Ïùò ÏùºÍ¥ÄÏÑ±ÏùÑ ÌôïÎ≥¥Ìï®.\n        \"\"\"\n        if not os.path.exists(self.json_path):\n            print(f\"‚ùå ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò Ïã§Ìå®: {self.json_path} ÌååÏùºÏù¥ Ï°¥Ïû¨ÌïòÏßÄ ÏïäÏäµÎãàÎã§.\")\n            return\n\n        with open(self.json_path, 'r', encoding='utf-8') as f:\n            data = json.load(f)\n\n        conn = sqlite3.connect(self.db_path)\n        cursor = conn.cursor()\n\n        # [Phase 1] ÎÖ∏Îìú Îç∞Ïù¥ÌÑ∞ ÏÇΩÏûÖ: Î™®Îì† Ïã¨Î≥ºÏùÑ Î®ºÏ†Ä DBÏóê Ï†ÅÏû¨ÌïòÏó¨ Í≥†Ïú† ID Ìï†Îãπ\n        print(f\"üöÄ [Phase 1] Ïã¨Î≥º ÎßàÏä§ÌÑ∞ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Ï§ë: {len(data)} Í±¥\")\n        for item in data:\n            cursor.execute(\"\"\"\n                INSERT INTO source_symbols (file_path, symbol_name, symbol_kind, start_line, end_line, content) \n                VALUES (?, ?, ?, ?, ?, ?)\n            \"\"\", (\n                self.clean_path(item['filePath']),\n                item['symbolName'],\n                item['symbolKind'],\n                item['startLine'],\n                item['endLine'],\n                item['content']\n            ))\n        conn.commit()\n\n        # [Phase 2] ÏóêÏßÄ Îç∞Ïù¥ÌÑ∞ Îß§Ìïë: Ï∞∏Ï°∞(References) Ï†ïÎ≥¥Î•º Î∂ÑÏÑùÌïòÏó¨ Ìò∏Ï∂ú Í¥ÄÍ≥Ñ Íµ¨Ï∂ï\n        print(\"üöÄ [Phase 2] Ïã¨Î≥º Í∞Ñ Ìò∏Ï∂ú Í¥ÄÍ≥Ñ(Graph Edge) Îß§Ìïë Ï§ë...\")\n        for callee_data in data:\n            # ÌîºÌò∏Ï∂úÏûê(Callee)Ïùò DB ID Ï°∞Ìöå\n            cursor.execute(\"\"\"\n                SELECT id FROM source_symbols \n                WHERE file_path = ? AND start_line = ? AND symbol_name = ?\n            \"\"\", (self.clean_path(callee_data['filePath']), callee_data['startLine'], callee_data['symbolName']))\n            row = cursor.fetchone()\n            if not row: continue\n            callee_id = row[0]\n\n            # Ïù¥ Ïã¨Î≥ºÏùÑ Ìò∏Ï∂úÌïòÎäî Î™®Îì† ÏßÄÏ†ê(references)ÏùÑ ÏàúÌöåÌïòÎ©∞ Caller ÏãùÎ≥Ñ\n            for ref in callee_data.get('references', []):\n                ref_path = self.clean_path(ref['refPath'])\n                ref_line = ref['startLine']\n\n                # Ìò∏Ï∂úÏù¥ Î∞úÏÉùÌïú ÎùºÏù∏ Î≤àÌò∏Î•º Î≤îÏúÑ(start_line ~ end_line)Î°ú Ìè¨Ìï®ÌïòÎäî Ìï®Ïàò/Î©îÏÑúÎìú ÌÉêÏÉâ\n                # Í∞ÄÏû• ÏûëÏùÄ Î≤îÏúÑ(Ìï®Ïàò)Í∞Ä CallerÍ∞Ä ÎêòÎèÑÎ°ù Ï†ïÎ†¨ Ï°∞Í±¥ Ï∂îÍ∞Ä\n                cursor.execute(\"\"\"\n                    SELECT id FROM source_symbols \n                    WHERE file_path = ? \n                      AND ? BETWEEN start_line AND end_line\n                      AND symbol_kind IN ('Method', 'Function', 'Class')\n                    ORDER BY (end_line - start_line) ASC\n                    LIMIT 1\n                \"\"\", (ref_path, ref_line))\n                \n                caller_row = cursor.fetchone()\n                if caller_row:\n                    caller_id = caller_row[0]\n                    # Ï§ëÎ≥µ Í¥ÄÍ≥Ñ Î∞©ÏßÄÎ•º ÏúÑÌï¥ Ïã†Ï§ëÌûà Ïù∏ÏÑúÌä∏ (ÌïÑÏöî Ïãú INSERT OR IGNORE Í∞ÄÎä•)\n                    cursor.execute(\"INSERT INTO symbol_relations (caller_id, callee_id) VALUES (?, ?)\", \n                                   (caller_id, callee_id))\n\n        conn.commit()\n        conn.close()\n        print(f\"‚ú® ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò ÏµúÏ¢Ö ÏôÑÎ£å.\")",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
        "startLine": 181
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "f",
    "symbolKind": "Kind(13)",
    "startLine": 86,
    "startChar": 60,
    "endLine": 86,
    "content": "with open(self.json_path, 'r', encoding='utf-8') as f:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "data",
    "symbolKind": "Kind(13)",
    "startLine": 87,
    "startChar": 12,
    "endLine": 87,
    "content": "data = json.load(f)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "conn",
    "symbolKind": "Kind(13)",
    "startLine": 89,
    "startChar": 8,
    "endLine": 89,
    "content": "conn = sqlite3.connect(self.db_path)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "cursor",
    "symbolKind": "Kind(13)",
    "startLine": 90,
    "startChar": 8,
    "endLine": 90,
    "content": "cursor = conn.cursor()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "item",
    "symbolKind": "Kind(13)",
    "startLine": 94,
    "startChar": 12,
    "endLine": 94,
    "content": "for item in data:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "callee_data",
    "symbolKind": "Kind(13)",
    "startLine": 110,
    "startChar": 12,
    "endLine": 110,
    "content": "for callee_data in data:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "row",
    "symbolKind": "Kind(13)",
    "startLine": 116,
    "startChar": 12,
    "endLine": 116,
    "content": "row = cursor.fetchone()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "callee_id",
    "symbolKind": "Kind(13)",
    "startLine": 118,
    "startChar": 12,
    "endLine": 118,
    "content": "callee_id = row[0]",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "ref",
    "symbolKind": "Kind(13)",
    "startLine": 121,
    "startChar": 16,
    "endLine": 121,
    "content": "for ref in callee_data.get('references', []):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "ref_path",
    "symbolKind": "Kind(13)",
    "startLine": 122,
    "startChar": 16,
    "endLine": 122,
    "content": "ref_path = self.clean_path(ref['refPath'])",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "ref_line",
    "symbolKind": "Kind(13)",
    "startLine": 123,
    "startChar": 16,
    "endLine": 123,
    "content": "ref_line = ref['startLine']",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "caller_row",
    "symbolKind": "Kind(13)",
    "startLine": 136,
    "startChar": 16,
    "endLine": 136,
    "content": "caller_row = cursor.fetchone()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "caller_id",
    "symbolKind": "Kind(13)",
    "startLine": 138,
    "startChar": 20,
    "endLine": 138,
    "content": "caller_id = caller_row[0]",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "verify_db",
    "symbolKind": "Method",
    "startLine": 147,
    "startChar": 4,
    "endLine": 175,
    "content": "def verify_db(self):\n        \"\"\"\n        Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• ÌõÑ Ï†ïÌï©ÏÑ± Í≤ÄÏ¶ùÏùÑ ÏúÑÌïú ÏÉÅÌÉú Î¶¨Ìè¨Ìä∏ Ï∂úÎ†•.\n        ÏÑ±Í≥µÏ†ÅÏù∏ ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò Ïó¨Î∂ÄÎ•º ÌåêÎã®ÌïòÎäî ÎîîÎ≤ÑÍπÖ ÎèÑÍµ¨.\n        \"\"\"\n        conn = sqlite3.connect(self.db_path)\n        cursor = conn.cursor()\n        \n        print(\"\\nüìä [DB Î¨¥Í≤∞ÏÑ± Í≤ÄÏ¶ù Î¶¨Ìè¨Ìä∏]\")\n        # Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞ Í∞úÏàò ÌôïÏù∏\n        cursor.execute(\"SELECT COUNT(*) FROM source_symbols\")\n        print(f\" - Ï¥ù Ïã¨Î≥º(Node) Ïàò: {cursor.fetchone()[0]}Í∞ú\")\n        \n        cursor.execute(\"SELECT COUNT(*) FROM symbol_relations\")\n        print(f\" - Ï¥ù Ìò∏Ï∂ú Í¥ÄÍ≥Ñ(Edge) Ïàò: {cursor.fetchone()[0]}Í∞ú\")\n        \n        # Í¥ÄÍ≥Ñ Îß§Ìïë Í≤∞Í≥º ÏÉòÌîåÎßÅ (Top 3)\n        print(\"\\nüîó [Ìò∏Ï∂ú Í∑∏ÎûòÌîÑ Ïó∞Í≤∞ÏÑ± ÌôïÏù∏ ÏÉòÌîå]\")\n        cursor.execute(\"\"\"\n            SELECT caller.symbol_name, callee.symbol_name \n            FROM symbol_relations r\n            JOIN source_symbols caller ON r.caller_id = caller.id\n            JOIN source_symbols callee ON r.callee_id = callee.id\n            LIMIT 3\n        \"\"\")\n        for row in cursor.fetchall():\n            print(f\"   [Caller] {row[0]} -> [Callee] {row[1]}\")\n            \n        conn.close()",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
        "startLine": 182
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "conn",
    "symbolKind": "Kind(13)",
    "startLine": 152,
    "startChar": 8,
    "endLine": 152,
    "content": "conn = sqlite3.connect(self.db_path)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "cursor",
    "symbolKind": "Kind(13)",
    "startLine": 153,
    "startChar": 8,
    "endLine": 153,
    "content": "cursor = conn.cursor()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "row",
    "symbolKind": "Kind(13)",
    "startLine": 172,
    "startChar": 12,
    "endLine": 172,
    "content": "for row in cursor.fetchall():",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "project_root",
    "symbolKind": "Kind(13)",
    "startLine": 17,
    "startChar": 13,
    "endLine": 17,
    "content": "self.project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "data_dir",
    "symbolKind": "Kind(13)",
    "startLine": 18,
    "startChar": 13,
    "endLine": 18,
    "content": "self.data_dir = os.path.join(self.project_root, \"data\")",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "db_path",
    "symbolKind": "Kind(13)",
    "startLine": 19,
    "startChar": 13,
    "endLine": 19,
    "content": "self.db_path = os.path.join(self.data_dir, db_name)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "json_path",
    "symbolKind": "Kind(13)",
    "startLine": 20,
    "startChar": 13,
    "endLine": 20,
    "content": "self.json_path = os.path.join(self.data_dir, \"symbols_output_lsp.json\")",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/json_to_sqlite.py",
    "symbolName": "indexer_db",
    "symbolKind": "Kind(13)",
    "startLine": 179,
    "startChar": 4,
    "endLine": 179,
    "content": "indexer_db = SourceIndexerDB(\"source_code_index_01.db\")",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "SelectColumn",
    "symbolKind": "Class",
    "startLine": 22,
    "startChar": 0,
    "endLine": 29,
    "content": "@dataclass\nclass SelectColumn:\n    \"\"\"SELECT Ï†àÏùò Ïª¨Îüº Ï†ïÎ≥¥\"\"\"\n    alias: str\n    expression: str\n    table: Optional[str] = None\n    column: Optional[str] = None\n    aggregation: Optional[str] = None",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "alias",
    "symbolKind": "Kind(13)",
    "startLine": 25,
    "startChar": 4,
    "endLine": 25,
    "content": "alias: str",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "expression",
    "symbolKind": "Kind(13)",
    "startLine": 26,
    "startChar": 4,
    "endLine": 26,
    "content": "expression: str",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "table",
    "symbolKind": "Kind(13)",
    "startLine": 27,
    "startChar": 4,
    "endLine": 27,
    "content": "table: Optional[str] = None",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "column",
    "symbolKind": "Kind(13)",
    "startLine": 28,
    "startChar": 4,
    "endLine": 28,
    "content": "column: Optional[str] = None",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "aggregation",
    "symbolKind": "Kind(13)",
    "startLine": 29,
    "startChar": 4,
    "endLine": 29,
    "content": "aggregation: Optional[str] = None",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "JoinInfo",
    "symbolKind": "Class",
    "startLine": 32,
    "startChar": 0,
    "endLine": 38,
    "content": "@dataclass\nclass JoinInfo:\n    \"\"\"JOIN Ï†ïÎ≥¥\"\"\"\n    type: str  # INNER JOIN, LEFT JOIN Îì±\n    table: str\n    on_condition: str\n    relationship: str",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "type",
    "symbolKind": "Kind(13)",
    "startLine": 35,
    "startChar": 4,
    "endLine": 35,
    "content": "type: str  # INNER JOIN, LEFT JOIN Îì±",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "table",
    "symbolKind": "Kind(13)",
    "startLine": 36,
    "startChar": 4,
    "endLine": 36,
    "content": "table: str",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "on_condition",
    "symbolKind": "Kind(13)",
    "startLine": 37,
    "startChar": 4,
    "endLine": 37,
    "content": "on_condition: str",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "relationship",
    "symbolKind": "Kind(13)",
    "startLine": 38,
    "startChar": 4,
    "endLine": 38,
    "content": "relationship: str",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "WhereCondition",
    "symbolKind": "Class",
    "startLine": 41,
    "startChar": 0,
    "endLine": 47,
    "content": "@dataclass\nclass WhereCondition:\n    \"\"\"WHERE Ï°∞Í±¥ Ï†ïÎ≥¥\"\"\"\n    column: str\n    operator: str\n    value: str\n    type: str  # partition_key, filter Îì±",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "column",
    "symbolKind": "Kind(13)",
    "startLine": 44,
    "startChar": 4,
    "endLine": 44,
    "content": "column: str",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "operator",
    "symbolKind": "Kind(13)",
    "startLine": 45,
    "startChar": 4,
    "endLine": 45,
    "content": "operator: str",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "value",
    "symbolKind": "Kind(13)",
    "startLine": 46,
    "startChar": 4,
    "endLine": 46,
    "content": "value: str",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "type",
    "symbolKind": "Kind(13)",
    "startLine": 47,
    "startChar": 4,
    "endLine": 47,
    "content": "type: str  # partition_key, filter Îì±",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "QueryStructure",
    "symbolKind": "Class",
    "startLine": 50,
    "startChar": 0,
    "endLine": 59,
    "content": "@dataclass\nclass QueryStructure:\n    \"\"\"ÏøºÎ¶¨ Íµ¨Ï°∞ Ï†ïÎ≥¥\"\"\"\n    select_columns: List[SelectColumn]\n    from_table: str\n    joins: List[JoinInfo]\n    where_conditions: List[WhereCondition]\n    group_by: List[str]\n    order_by: List[str]\n    having: Optional[str] = None",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "select_columns",
    "symbolKind": "Kind(13)",
    "startLine": 53,
    "startChar": 4,
    "endLine": 53,
    "content": "select_columns: List[SelectColumn]",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "from_table",
    "symbolKind": "Kind(13)",
    "startLine": 54,
    "startChar": 4,
    "endLine": 54,
    "content": "from_table: str",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "joins",
    "symbolKind": "Kind(13)",
    "startLine": 55,
    "startChar": 4,
    "endLine": 55,
    "content": "joins: List[JoinInfo]",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "where_conditions",
    "symbolKind": "Kind(13)",
    "startLine": 56,
    "startChar": 4,
    "endLine": 56,
    "content": "where_conditions: List[WhereCondition]",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "group_by",
    "symbolKind": "Kind(13)",
    "startLine": 57,
    "startChar": 4,
    "endLine": 57,
    "content": "group_by: List[str]",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "order_by",
    "symbolKind": "Kind(13)",
    "startLine": 58,
    "startChar": 4,
    "endLine": 58,
    "content": "order_by: List[str]",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "having",
    "symbolKind": "Kind(13)",
    "startLine": 59,
    "startChar": 4,
    "endLine": 59,
    "content": "having: Optional[str] = None",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "SQLQueryAnalyzer",
    "symbolKind": "Class",
    "startLine": 62,
    "startChar": 0,
    "endLine": 506,
    "content": "class SQLQueryAnalyzer:\n    \"\"\"SQL ÏøºÎ¶¨ Î∂ÑÏÑù Î∞è JSON Î≥ÄÌôò\"\"\"\n    \n    def __init__(self, data_dir: str = None):\n        \"\"\"\n        Args:\n            data_dir: JSON ÌååÏùºÏùÑ Ï†ÄÏû•Ìï† ÎîîÎ†âÌÜ†Î¶¨\n        \"\"\"\n        if data_dir is None:\n            project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))\n            self.data_dir = os.path.join(project_root, \"data\")\n        else:\n            self.data_dir = data_dir\n            \n        if not os.path.exists(self.data_dir):\n            os.makedirs(self.data_dir)\n    \n    def normalize_sql(self, sql: str) -> str:\n        \"\"\"\n        SQLÏóêÏÑú ÌÖåÏù¥Î∏î aliasÎ•º Ï†úÍ±∞ÌïòÍ≥† Ï†ïÍ∑úÌôî\n        \n        Ïòà: \"FROM Trip_Log T\" -> \"FROM Trip_Log\"\n            \"T.trip_id\" -> \"Trip_Log.trip_id\"\n        \"\"\"\n        # 1. alias Îß§Ìïë Ï∂îÏ∂ú\n        alias_map = {}\n        \n        # FROM Ï†àÏóêÏÑú alias Ï∂îÏ∂ú\n        from_pattern = r'\\bFROM\\s+(\\w+)\\s+(\\w+)\\b'\n        for match in re.finditer(from_pattern, sql, re.IGNORECASE):\n            table_name = match.group(1)\n            alias = match.group(2)\n            # ÌÇ§ÏõåÎìúÍ∞Ä ÏïÑÎãå Í≤ΩÏö∞Îßå aliasÎ°ú Í∞ÑÏ£º\n            if alias.upper() not in ['INNER', 'LEFT', 'RIGHT', 'FULL', 'CROSS', 'WHERE', 'GROUP', 'ORDER', 'HAVING', 'ON']:\n                alias_map[alias] = table_name\n        \n        # JOIN Ï†àÏóêÏÑú alias Ï∂îÏ∂ú\n        join_pattern = r'\\bJOIN\\s+(\\w+)\\s+(\\w+)\\b'\n        for match in re.finditer(join_pattern, sql, re.IGNORECASE):\n            table_name = match.group(1)\n            alias = match.group(2)\n            if alias.upper() not in ['ON', 'WHERE', 'GROUP', 'ORDER', 'HAVING']:\n                alias_map[alias] = table_name\n        \n        # 2. alias Ï∞∏Ï°∞Î•º ÌÖåÏù¥Î∏îÎ™ÖÏúºÎ°ú Î≥ÄÌôò\n        normalized = sql\n        for alias, table_name in alias_map.items():\n            # alias.column -> table_name.column\n            normalized = re.sub(\n                rf'\\b{alias}\\.(\\w+)',\n                rf'{table_name}.\\1',\n                normalized\n            )\n        \n        # 3. FROM/JOIN Ï†àÏóêÏÑú alias Ï†úÍ±∞\n        normalized = re.sub(\n            r'\\bFROM\\s+(\\w+)\\s+\\w+\\b',\n            r'FROM \\1',\n            normalized,\n            flags=re.IGNORECASE\n        )\n        \n        normalized = re.sub(\n            r'\\bJOIN\\s+(\\w+)\\s+\\w+\\b',\n            r'JOIN \\1',\n            normalized,\n            flags=re.IGNORECASE\n        )\n        \n        return normalized\n    \n    def parse_select_columns(self, parsed) -> List[SelectColumn]:\n        \"\"\"SELECT Ï†àÏùò Ïª¨Îüº ÌååÏã±\"\"\"\n        columns = []\n        \n        for token in parsed.tokens:\n            if isinstance(token, IdentifierList):\n                for identifier in token.get_identifiers():\n                    col = self._parse_identifier(identifier)\n                    if col:\n                        columns.append(col)\n            elif isinstance(token, Identifier):\n                col = self._parse_identifier(token)\n                if col:\n                    columns.append(col)\n            elif token.ttype is DML and token.value.upper() == 'SELECT':\n                # SELECT Îã§Ïùå ÌÜ†ÌÅ∞Îì§ ÌôïÏù∏\n                idx = parsed.token_index(token)\n                for next_token in parsed.tokens[idx+1:]:\n                    if next_token.ttype is Keyword:\n                        break\n                    if isinstance(next_token, (Identifier, IdentifierList)):\n                        continue\n                    if not next_token.is_whitespace:\n                        # Îã®Ïùº Ïª¨Îüº (alias ÏóÜÏùå)\n                        col_str = str(next_token).strip()\n                        if col_str and col_str.upper() not in ['FROM', 'WHERE', 'GROUP', 'ORDER']:\n                            col = self._parse_column_expression(col_str)\n                            if col:\n                                columns.append(col)\n        \n        return columns\n    \n    def _parse_identifier(self, identifier) -> Optional[SelectColumn]:\n        \"\"\"Identifier ÌÜ†ÌÅ∞ÏóêÏÑú Ïª¨Îüº Ï†ïÎ≥¥ Ï∂îÏ∂ú\"\"\"\n        alias = identifier.get_alias()\n        expr = identifier.get_real_name() or str(identifier).split(' AS ')[0].strip()\n        \n        return self._parse_column_expression(expr, alias)\n    \n    def _parse_column_expression(self, expr: str, alias: str = None) -> Optional[SelectColumn]:\n        \"\"\"Ïª¨Îüº ÌëúÌòÑÏãù ÌååÏã±\"\"\"\n        expr = expr.strip().strip(\"'\\\"\")\n        \n        if not expr:\n            return None\n        \n        # ÏßëÍ≥Ñ Ìï®Ïàò ÌôïÏù∏\n        agg_match = re.match(r'(COUNT|SUM|AVG|MAX|MIN|STDDEV|VARIANCE)\\s*\\((.*)\\)', expr, re.IGNORECASE)\n        aggregation = None\n        \n        if agg_match:\n            aggregation = agg_match.group(1).upper()\n            inner_expr = agg_match.group(2).strip()\n        else:\n            inner_expr = expr\n        \n        # ÌÖåÏù¥Î∏î.Ïª¨Îüº ÌòïÏãù ÌååÏã±\n        table = None\n        column = None\n        \n        if '.' in inner_expr:\n            parts = inner_expr.split('.')\n            if len(parts) == 2:\n                table = parts[0].strip()\n                column = parts[1].strip()\n        else:\n            column = inner_expr\n        \n        # aliasÍ∞Ä ÏóÜÏúºÎ©¥ Ïª¨ÎüºÎ™Ö ÏÇ¨Ïö©\n        if not alias:\n            alias = column or expr\n        \n        return SelectColumn(\n            alias=alias,\n            expression=expr,\n            table=table,\n            column=column,\n            aggregation=aggregation\n        )\n    \n    def parse_joins(self, sql: str) -> List[JoinInfo]:\n        \"\"\"JOIN Ï†à ÌååÏã±\"\"\"\n        joins = []\n        \n        # JOIN Ìå®ÌÑ¥: (INNER|LEFT|RIGHT|FULL) JOIN table ON condition\n        join_pattern = r'(INNER\\s+JOIN|LEFT\\s+(?:OUTER\\s+)?JOIN|RIGHT\\s+(?:OUTER\\s+)?JOIN|FULL\\s+(?:OUTER\\s+)?JOIN|JOIN)\\s+(\\w+)(?:\\s+\\w+)?\\s+ON\\s+([^\\n]+?)(?=(?:INNER|LEFT|RIGHT|FULL|JOIN|WHERE|GROUP|ORDER|$))'\n        \n        for match in re.finditer(join_pattern, sql, re.IGNORECASE | re.DOTALL):\n            join_type = match.group(1).strip()\n            table = match.group(2).strip()\n            on_condition = match.group(3).strip()\n            \n            # ON Ï°∞Í±¥ÏóêÏÑú Í¥ÄÍ≥Ñ Ï∂îÏ∂ú\n            # Ïòà: T.route_id = R.route_id -> Trip_Log.route_id = Route_Master.route_id\n            relationship = on_condition\n            \n            joins.append(JoinInfo(\n                type=join_type,\n                table=table,\n                on_condition=on_condition,\n                relationship=relationship\n            ))\n        \n        return joins\n    \n    def parse_where_conditions(self, parsed) -> List[WhereCondition]:\n        \"\"\"WHERE Ï†à ÌååÏã±\"\"\"\n        conditions = []\n        \n        for token in parsed.tokens:\n            if isinstance(token, Where):\n                where_str = str(token)[6:].strip()  # \"WHERE \" Ï†úÍ±∞\n                \n                # ANDÎ°ú Î∂ÑÎ¶¨\n                parts = re.split(r'\\s+AND\\s+', where_str, flags=re.IGNORECASE)\n                \n                for part in parts:\n                    part = part.strip()\n                    \n                    # Ï°∞Í±¥ ÌååÏã±: column operator value\n                    # Ïòà: T.base_date = '20251219'\n                    match = re.match(r\"([\\w.]+)\\s*(=|!=|<>|>|<|>=|<=|LIKE|IN)\\s*(.+)\", part, re.IGNORECASE)\n                    \n                    if match:\n                        column = match.group(1).strip()\n                        operator = match.group(2).strip()\n                        value = match.group(3).strip()\n                        \n                        # Ï°∞Í±¥ ÌÉÄÏûÖ ÌåêÎã®\n                        cond_type = \"filter\"\n                        if \"base_date\" in column.lower() or \"partition\" in column.lower():\n                            cond_type = \"partition_key\"\n                        \n                        conditions.append(WhereCondition(\n                            column=column,\n                            operator=operator,\n                            value=value,\n                            type=cond_type\n                        ))\n        \n        return conditions\n    \n    def parse_group_by(self, sql: str) -> List[str]:\n        \"\"\"GROUP BY Ï†à ÌååÏã±\"\"\"\n        match = re.search(r'GROUP\\s+BY\\s+([^\\n]+?)(?=ORDER|HAVING|$)', sql, re.IGNORECASE | re.DOTALL)\n        if match:\n            group_str = match.group(1).strip()\n            return [col.strip() for col in group_str.split(',')]\n        return []\n    \n    def parse_order_by(self, sql: str) -> List[str]:\n        \"\"\"ORDER BY Ï†à ÌååÏã±\"\"\"\n        match = re.search(r'ORDER\\s+BY\\s+([^\\n]+?)$', sql, re.IGNORECASE | re.DOTALL)\n        if match:\n            order_str = match.group(1).strip()\n            return [col.strip() for col in order_str.split(',')]\n        return []\n    \n    def classify_query_unit(self, structure: QueryStructure) -> tuple[str, str, List[str]]:\n        \"\"\"\n        ÏøºÎ¶¨Î•º unitA/B/CÎ°ú Î∂ÑÎ•ò\n        \n        Returns:\n            (unit_type, unit_description, entities)\n        \"\"\"\n        # ÌÖåÏù¥Î∏î Í∞úÏàò ÌôïÏù∏\n        tables = set()\n        tables.add(structure.from_table)\n        for join in structure.joins:\n            tables.add(join.table)\n        \n        # SELECT Ï†àÏóêÏÑú ÏóîÌã∞Ìã∞ Ï∂îÏ∂ú\n        entities = []\n        for col in structure.select_columns:\n            if col.table and col.table not in entities:\n                # ÌÖåÏù¥Î∏îÎ™ÖÏóêÏÑú ÏóîÌã∞Ìã∞Î™Ö Ï∂îÏ∂ú (Ïòà: Route_Master -> ÎÖ∏ÏÑ†)\n                entity = self._extract_entity_name(col.table)\n                if entity:\n                    entities.append(entity)\n        \n        # Î∂ÑÎ•ò Î°úÏßÅ\n        if len(tables) == 1:\n            return \"unitA\", \"Îã®Ïàú ÌÖåÏù¥Î∏î\", entities\n        elif len(tables) == 2:\n            return \"unitB\", \"ÏÉÅÏÑ∏ Ï†ïÎ≥¥\", entities\n        else:\n            return \"unitC\", f\"Î≥µÌï© Ï†ïÎ≥¥ ({' + '.join(entities)})\", entities\n    \n    def _extract_entity_name(self, table_name: str) -> str:\n        \"\"\"ÌÖåÏù¥Î∏îÎ™ÖÏóêÏÑú ÏóîÌã∞Ìã∞Î™Ö Ï∂îÏ∂ú\"\"\"\n        # Í∞ÑÎã®Ìïú Îß§Ìïë (Ïã§Ï†úÎ°úÎäî DictionaryÏóêÏÑú Í∞ÄÏ†∏ÏôÄÏïº Ìï®)\n        entity_map = {\n            \"Route_Master\": \"ÎÖ∏ÏÑ†\",\n            \"Station_Master\": \"Ï†ïÎ•òÏû•\",\n            \"Trip_Log\": \"Ïù¥Ïö©\",\n            \"Bus_Master\": \"Î≤ÑÏä§\",\n            \"Driver_Master\": \"Í∏∞ÏÇ¨\"\n        }\n        return entity_map.get(table_name, table_name)\n    \n    def infer_presentation_type(self, structure: QueryStructure) -> Dict[str, Any]:\n        \"\"\"Presentation ÌÉÄÏûÖ Ï∂îÎ°†\"\"\"\n        # ÏßëÍ≥Ñ Ìï®ÏàòÍ∞Ä ÏûàÍ≥† GROUP BYÍ∞Ä ÏûàÏúºÎ©¥ Ï∞®Ìä∏\n        has_aggregation = any(col.aggregation for col in structure.select_columns)\n        has_group_by = len(structure.group_by) > 0\n        \n        if has_aggregation and has_group_by:\n            # Ï≤´ Î≤àÏß∏ GROUP BY Ïª¨ÎüºÏùÑ xÏ∂ïÏúºÎ°ú\n            x_col = structure.select_columns[0] if structure.select_columns else None\n            # ÏßëÍ≥Ñ Ïª¨ÎüºÏùÑ yÏ∂ïÏúºÎ°ú\n            y_col = next((col for col in structure.select_columns if col.aggregation), None)\n            \n            return {\n                \"chart_type\": \"bar\",\n                \"x_axis\": x_col.alias if x_col else \"category\",\n                \"y_axis\": y_col.alias if y_col else \"value\",\n                \"title\": \"ÏßëÍ≥Ñ Í≤∞Í≥º\"\n            }\n        else:\n            return {\n                \"chart_type\": \"table\",\n                \"title\": \"Ï°∞Ìöå Í≤∞Í≥º\"\n            }\n    \n    def analyze_query(\n        self, \n        sql: str, \n        question: str = None,\n        query_id: str = None,\n        description: str = None\n    ) -> Dict[str, Any]:\n        \"\"\"\n        SQL ÏøºÎ¶¨ Î∂ÑÏÑù Î∞è JSON ÏÉùÏÑ±\n        \n        Args:\n            sql: Î∂ÑÏÑùÌï† SQL ÏøºÎ¶¨\n            question: ÏøºÎ¶¨Ïóê ÎåÄÌïú ÏßàÎ¨∏\n            query_id: ÏøºÎ¶¨ ID\n            description: ÏøºÎ¶¨ ÏÑ§Î™Ö\n            \n        Returns:\n            Î∂ÑÏÑù Í≤∞Í≥º ÎîïÏÖîÎÑàÎ¶¨\n        \"\"\"\n        # SQL ÌååÏã±\n        parsed = sqlparse.parse(sql)[0]\n        \n        # Ï†ïÍ∑úÌôîÎêú SQL\n        normalized_sql = self.normalize_sql(sql)\n        \n        # Íµ¨Ï°∞ ÌååÏã±\n        select_columns = self.parse_select_columns(parsed)\n        joins = self.parse_joins(sql)\n        where_conditions = self.parse_where_conditions(parsed)\n        group_by = self.parse_group_by(sql)\n        order_by = self.parse_order_by(sql)\n        \n        # FROM ÌÖåÏù¥Î∏î Ï∂îÏ∂ú\n        from_match = re.search(r'FROM\\s+(\\w+)', sql, re.IGNORECASE)\n        from_table = from_match.group(1) if from_match else \"Unknown\"\n        \n        structure = QueryStructure(\n            select_columns=select_columns,\n            from_table=from_table,\n            joins=joins,\n            where_conditions=where_conditions,\n            group_by=group_by,\n            order_by=order_by\n        )\n        \n        # ÏøºÎ¶¨ Î∂ÑÎ•ò\n        unit_type, unit_desc, entities = self.classify_query_unit(structure)\n        \n        # Presentation ÌÉÄÏûÖ Ï∂îÎ°†\n        presentation_config = self.infer_presentation_type(structure)\n        \n        # JOIN Í∑∏ÎûòÌîÑ ÏÉùÏÑ±\n        join_graph = []\n        for join in joins:\n            join_graph.append(f\"{from_table} -> {join.table} ({join.on_condition})\")\n        \n        # ÏàòÏ†ï Í∞ÄÎä•Ìïú ÌååÎùºÎØ∏ÌÑ∞ Ï∂îÏ∂ú\n        modifiable_params = [cond.column.split('.')[-1] for cond in where_conditions]\n        \n        # JSON Í≤∞Í≥º ÏÉùÏÑ±\n        result = {\n            \"query_id\": query_id or f\"q_{datetime.now().strftime('%Y%m%d%H%M%S')}\",\n            \"question\": question or \"ÏßàÎ¨∏ ÏóÜÏùå\",\n            \"description\": description or \"ÏÑ§Î™Ö ÏóÜÏùå\",\n            \"unit_type\": unit_type,\n            \"unit_description\": unit_desc,\n            \"entities\": entities,\n            \"presentation_type\": \"table_with_chart\" if presentation_config[\"chart_type\"] != \"table\" else \"table\",\n            \"presentation_config\": presentation_config,\n            \"sql\": {\n                \"original\": sql,\n                \"normalized\": normalized_sql,\n                \"structure\": {\n                    \"select_columns\": [asdict(col) for col in select_columns],\n                    \"from_table\": from_table,\n                    \"joins\": [asdict(join) for join in joins],\n                    \"where_conditions\": [asdict(cond) for cond in where_conditions],\n                    \"group_by\": group_by,\n                    \"order_by\": order_by\n                }\n            },\n            \"relationships\": {\n                \"fixed\": True,\n                \"description\": f\"{from_table}Î•º Ï§ëÏã¨ÏúºÎ°ú {', '.join([j.table for j in joins])}Î•º Ï°∞Ïù∏\",\n                \"join_graph\": join_graph\n            },\n            \"parameters\": {\n                \"modifiable\": modifiable_params,\n                \"fixed\": [\"joins\", \"select_columns\", \"group_by\"],\n                \"template\": question.replace(' ', '_') if question else \"custom_query\"\n            },\n            \"metadata\": {\n                \"created_at\": datetime.now().isoformat(),\n                \"tags\": entities,\n                \"complexity\": \"low\" if unit_type == \"unitA\" else (\"medium\" if unit_type == \"unitB\" else \"high\"),\n                \"estimated_rows\": \"< 100\" if len(where_conditions) > 0 else \"unknown\"\n            }\n        }\n        \n        return result\n    \n    def save_to_json(self, result: Dict[str, Any], filename: str = None) -> str:\n        \"\"\"Î∂ÑÏÑù Í≤∞Í≥ºÎ•º JSON ÌååÏùºÎ°ú Ï†ÄÏû•\"\"\"\n        if filename is None:\n            filename = f\"query_{result['query_id']}.json\"\n        \n        filepath = os.path.join(self.data_dir, filename)\n        \n        with open(filepath, 'w', encoding='utf-8') as f:\n            json.dump(result, f, indent=2, ensure_ascii=False)\n        \n        print(f\"‚úÖ JSON Ï†ÄÏû• ÏôÑÎ£å: {filepath}\")\n        return filepath\n    \n    def batch_analyze(self, queries: List[Dict[str, str]]) -> List[Dict[str, Any]]:\n        \"\"\"\n        Ïó¨Îü¨ ÏøºÎ¶¨Î•º ÏùºÍ¥Ñ Î∂ÑÏÑù\n        \n        Args:\n            queries: [{\"sql\": \"...\", \"question\": \"...\", \"query_id\": \"...\"}, ...]\n            \n        Returns:\n            Î∂ÑÏÑù Í≤∞Í≥º Î¶¨Ïä§Ìä∏\n        \"\"\"\n        results = []\n        \n        for query_info in queries:\n            print(f\"\\nüîç Î∂ÑÏÑù Ï§ë: {query_info.get('question', 'Unknown')}\")\n            \n            result = self.analyze_query(\n                sql=query_info['sql'],\n                question=query_info.get('question'),\n                query_id=query_info.get('query_id'),\n                description=query_info.get('description')\n            )\n            \n            results.append(result)\n            \n            # Í∞úÎ≥Ñ JSON ÌååÏùºÎ°ú Ï†ÄÏû•\n            self.save_to_json(result)\n        \n        # Ï†ÑÏ≤¥ Í≤∞Í≥ºÎèÑ ÌïòÎÇòÏùò ÌååÏùºÎ°ú Ï†ÄÏû•\n        all_results_path = os.path.join(self.data_dir, \"all_queries.json\")\n        with open(all_results_path, 'w', encoding='utf-8') as f:\n            json.dump(results, f, indent=2, ensure_ascii=False)\n        \n        print(f\"\\n‚ú® Ï†ÑÏ≤¥ Î∂ÑÏÑù ÏôÑÎ£å! Ï¥ù {len(results)}Í∞ú ÏøºÎ¶¨ Î∂ÑÏÑùÎê®\")\n        print(f\"üìÅ Ï†ÑÏ≤¥ Í≤∞Í≥º: {all_results_path}\")\n        \n        return results",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "__init__",
    "symbolKind": "Method",
    "startLine": 65,
    "startChar": 4,
    "endLine": 77,
    "content": "def __init__(self, data_dir: str = None):\n        \"\"\"\n        Args:\n            data_dir: JSON ÌååÏùºÏùÑ Ï†ÄÏû•Ìï† ÎîîÎ†âÌÜ†Î¶¨\n        \"\"\"\n        if data_dir is None:\n            project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))\n            self.data_dir = os.path.join(project_root, \"data\")\n        else:\n            self.data_dir = data_dir\n            \n        if not os.path.exists(self.data_dir):\n            os.makedirs(self.data_dir)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "data_dir",
    "symbolKind": "Kind(13)",
    "startLine": 65,
    "startChar": 23,
    "endLine": 65,
    "content": "def __init__(self, data_dir: str = None):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "project_root",
    "symbolKind": "Kind(13)",
    "startLine": 71,
    "startChar": 12,
    "endLine": 71,
    "content": "project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "normalize_sql",
    "symbolKind": "Method",
    "startLine": 79,
    "startChar": 4,
    "endLine": 131,
    "content": "def normalize_sql(self, sql: str) -> str:\n        \"\"\"\n        SQLÏóêÏÑú ÌÖåÏù¥Î∏î aliasÎ•º Ï†úÍ±∞ÌïòÍ≥† Ï†ïÍ∑úÌôî\n        \n        Ïòà: \"FROM Trip_Log T\" -> \"FROM Trip_Log\"\n            \"T.trip_id\" -> \"Trip_Log.trip_id\"\n        \"\"\"\n        # 1. alias Îß§Ìïë Ï∂îÏ∂ú\n        alias_map = {}\n        \n        # FROM Ï†àÏóêÏÑú alias Ï∂îÏ∂ú\n        from_pattern = r'\\bFROM\\s+(\\w+)\\s+(\\w+)\\b'\n        for match in re.finditer(from_pattern, sql, re.IGNORECASE):\n            table_name = match.group(1)\n            alias = match.group(2)\n            # ÌÇ§ÏõåÎìúÍ∞Ä ÏïÑÎãå Í≤ΩÏö∞Îßå aliasÎ°ú Í∞ÑÏ£º\n            if alias.upper() not in ['INNER', 'LEFT', 'RIGHT', 'FULL', 'CROSS', 'WHERE', 'GROUP', 'ORDER', 'HAVING', 'ON']:\n                alias_map[alias] = table_name\n        \n        # JOIN Ï†àÏóêÏÑú alias Ï∂îÏ∂ú\n        join_pattern = r'\\bJOIN\\s+(\\w+)\\s+(\\w+)\\b'\n        for match in re.finditer(join_pattern, sql, re.IGNORECASE):\n            table_name = match.group(1)\n            alias = match.group(2)\n            if alias.upper() not in ['ON', 'WHERE', 'GROUP', 'ORDER', 'HAVING']:\n                alias_map[alias] = table_name\n        \n        # 2. alias Ï∞∏Ï°∞Î•º ÌÖåÏù¥Î∏îÎ™ÖÏúºÎ°ú Î≥ÄÌôò\n        normalized = sql\n        for alias, table_name in alias_map.items():\n            # alias.column -> table_name.column\n            normalized = re.sub(\n                rf'\\b{alias}\\.(\\w+)',\n                rf'{table_name}.\\1',\n                normalized\n            )\n        \n        # 3. FROM/JOIN Ï†àÏóêÏÑú alias Ï†úÍ±∞\n        normalized = re.sub(\n            r'\\bFROM\\s+(\\w+)\\s+\\w+\\b',\n            r'FROM \\1',\n            normalized,\n            flags=re.IGNORECASE\n        )\n        \n        normalized = re.sub(\n            r'\\bJOIN\\s+(\\w+)\\s+\\w+\\b',\n            r'JOIN \\1',\n            normalized,\n            flags=re.IGNORECASE\n        )\n        \n        return normalized",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 380
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "sql",
    "symbolKind": "Kind(13)",
    "startLine": 79,
    "startChar": 28,
    "endLine": 79,
    "content": "def normalize_sql(self, sql: str) -> str:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "alias_map",
    "symbolKind": "Kind(13)",
    "startLine": 87,
    "startChar": 8,
    "endLine": 87,
    "content": "alias_map = {}",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "from_pattern",
    "symbolKind": "Kind(13)",
    "startLine": 90,
    "startChar": 8,
    "endLine": 90,
    "content": "from_pattern = r'\\bFROM\\s+(\\w+)\\s+(\\w+)\\b'",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "match",
    "symbolKind": "Kind(13)",
    "startLine": 91,
    "startChar": 12,
    "endLine": 91,
    "content": "for match in re.finditer(from_pattern, sql, re.IGNORECASE):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "table_name",
    "symbolKind": "Kind(13)",
    "startLine": 92,
    "startChar": 12,
    "endLine": 92,
    "content": "table_name = match.group(1)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "alias",
    "symbolKind": "Kind(13)",
    "startLine": 93,
    "startChar": 12,
    "endLine": 93,
    "content": "alias = match.group(2)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "join_pattern",
    "symbolKind": "Kind(13)",
    "startLine": 99,
    "startChar": 8,
    "endLine": 99,
    "content": "join_pattern = r'\\bJOIN\\s+(\\w+)\\s+(\\w+)\\b'",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "normalized",
    "symbolKind": "Kind(13)",
    "startLine": 107,
    "startChar": 8,
    "endLine": 107,
    "content": "normalized = sql",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "parse_select_columns",
    "symbolKind": "Method",
    "startLine": 133,
    "startChar": 4,
    "endLine": 163,
    "content": "def parse_select_columns(self, parsed) -> List[SelectColumn]:\n        \"\"\"SELECT Ï†àÏùò Ïª¨Îüº ÌååÏã±\"\"\"\n        columns = []\n        \n        for token in parsed.tokens:\n            if isinstance(token, IdentifierList):\n                for identifier in token.get_identifiers():\n                    col = self._parse_identifier(identifier)\n                    if col:\n                        columns.append(col)\n            elif isinstance(token, Identifier):\n                col = self._parse_identifier(token)\n                if col:\n                    columns.append(col)\n            elif token.ttype is DML and token.value.upper() == 'SELECT':\n                # SELECT Îã§Ïùå ÌÜ†ÌÅ∞Îì§ ÌôïÏù∏\n                idx = parsed.token_index(token)\n                for next_token in parsed.tokens[idx+1:]:\n                    if next_token.ttype is Keyword:\n                        break\n                    if isinstance(next_token, (Identifier, IdentifierList)):\n                        continue\n                    if not next_token.is_whitespace:\n                        # Îã®Ïùº Ïª¨Îüº (alias ÏóÜÏùå)\n                        col_str = str(next_token).strip()\n                        if col_str and col_str.upper() not in ['FROM', 'WHERE', 'GROUP', 'ORDER']:\n                            col = self._parse_column_expression(col_str)\n                            if col:\n                                columns.append(col)\n        \n        return columns",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 383
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "parsed",
    "symbolKind": "Kind(13)",
    "startLine": 133,
    "startChar": 35,
    "endLine": 133,
    "content": "def parse_select_columns(self, parsed) -> List[SelectColumn]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "columns",
    "symbolKind": "Kind(13)",
    "startLine": 135,
    "startChar": 8,
    "endLine": 135,
    "content": "columns = []",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "token",
    "symbolKind": "Kind(13)",
    "startLine": 137,
    "startChar": 12,
    "endLine": 137,
    "content": "for token in parsed.tokens:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "identifier",
    "symbolKind": "Kind(13)",
    "startLine": 139,
    "startChar": 20,
    "endLine": 139,
    "content": "for identifier in token.get_identifiers():",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "col",
    "symbolKind": "Kind(13)",
    "startLine": 140,
    "startChar": 20,
    "endLine": 140,
    "content": "col = self._parse_identifier(identifier)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "idx",
    "symbolKind": "Kind(13)",
    "startLine": 149,
    "startChar": 16,
    "endLine": 149,
    "content": "idx = parsed.token_index(token)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "next_token",
    "symbolKind": "Kind(13)",
    "startLine": 150,
    "startChar": 20,
    "endLine": 150,
    "content": "for next_token in parsed.tokens[idx+1:]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "col_str",
    "symbolKind": "Kind(13)",
    "startLine": 157,
    "startChar": 24,
    "endLine": 157,
    "content": "col_str = str(next_token).strip()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "_parse_identifier",
    "symbolKind": "Method",
    "startLine": 165,
    "startChar": 4,
    "endLine": 170,
    "content": "def _parse_identifier(self, identifier) -> Optional[SelectColumn]:\n        \"\"\"Identifier ÌÜ†ÌÅ∞ÏóêÏÑú Ïª¨Îüº Ï†ïÎ≥¥ Ï∂îÏ∂ú\"\"\"\n        alias = identifier.get_alias()\n        expr = identifier.get_real_name() or str(identifier).split(' AS ')[0].strip()\n        \n        return self._parse_column_expression(expr, alias)",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 140
      },
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 144
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "identifier",
    "symbolKind": "Kind(13)",
    "startLine": 165,
    "startChar": 32,
    "endLine": 165,
    "content": "def _parse_identifier(self, identifier) -> Optional[SelectColumn]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "alias",
    "symbolKind": "Kind(13)",
    "startLine": 167,
    "startChar": 8,
    "endLine": 167,
    "content": "alias = identifier.get_alias()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "expr",
    "symbolKind": "Kind(13)",
    "startLine": 168,
    "startChar": 8,
    "endLine": 168,
    "content": "expr = identifier.get_real_name() or str(identifier).split(' AS ')[0].strip()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "_parse_column_expression",
    "symbolKind": "Method",
    "startLine": 172,
    "startChar": 4,
    "endLine": 211,
    "content": "def _parse_column_expression(self, expr: str, alias: str = None) -> Optional[SelectColumn]:\n        \"\"\"Ïª¨Îüº ÌëúÌòÑÏãù ÌååÏã±\"\"\"\n        expr = expr.strip().strip(\"'\\\"\")\n        \n        if not expr:\n            return None\n        \n        # ÏßëÍ≥Ñ Ìï®Ïàò ÌôïÏù∏\n        agg_match = re.match(r'(COUNT|SUM|AVG|MAX|MIN|STDDEV|VARIANCE)\\s*\\((.*)\\)', expr, re.IGNORECASE)\n        aggregation = None\n        \n        if agg_match:\n            aggregation = agg_match.group(1).upper()\n            inner_expr = agg_match.group(2).strip()\n        else:\n            inner_expr = expr\n        \n        # ÌÖåÏù¥Î∏î.Ïª¨Îüº ÌòïÏãù ÌååÏã±\n        table = None\n        column = None\n        \n        if '.' in inner_expr:\n            parts = inner_expr.split('.')\n            if len(parts) == 2:\n                table = parts[0].strip()\n                column = parts[1].strip()\n        else:\n            column = inner_expr\n        \n        # aliasÍ∞Ä ÏóÜÏúºÎ©¥ Ïª¨ÎüºÎ™Ö ÏÇ¨Ïö©\n        if not alias:\n            alias = column or expr\n        \n        return SelectColumn(\n            alias=alias,\n            expression=expr,\n            table=table,\n            column=column,\n            aggregation=aggregation\n        )",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 159
      },
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 170
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "expr",
    "symbolKind": "Kind(13)",
    "startLine": 172,
    "startChar": 39,
    "endLine": 172,
    "content": "def _parse_column_expression(self, expr: str, alias: str = None) -> Optional[SelectColumn]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "alias",
    "symbolKind": "Kind(13)",
    "startLine": 172,
    "startChar": 50,
    "endLine": 172,
    "content": "def _parse_column_expression(self, expr: str, alias: str = None) -> Optional[SelectColumn]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "agg_match",
    "symbolKind": "Kind(13)",
    "startLine": 180,
    "startChar": 8,
    "endLine": 180,
    "content": "agg_match = re.match(r'(COUNT|SUM|AVG|MAX|MIN|STDDEV|VARIANCE)\\s*\\((.*)\\)', expr, re.IGNORECASE)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "aggregation",
    "symbolKind": "Kind(13)",
    "startLine": 181,
    "startChar": 8,
    "endLine": 181,
    "content": "aggregation = None",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "inner_expr",
    "symbolKind": "Kind(13)",
    "startLine": 185,
    "startChar": 12,
    "endLine": 185,
    "content": "inner_expr = agg_match.group(2).strip()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "table",
    "symbolKind": "Kind(13)",
    "startLine": 190,
    "startChar": 8,
    "endLine": 190,
    "content": "table = None",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "column",
    "symbolKind": "Kind(13)",
    "startLine": 191,
    "startChar": 8,
    "endLine": 191,
    "content": "column = None",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "parts",
    "symbolKind": "Kind(13)",
    "startLine": 194,
    "startChar": 12,
    "endLine": 194,
    "content": "parts = inner_expr.split('.')",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "parse_joins",
    "symbolKind": "Method",
    "startLine": 213,
    "startChar": 4,
    "endLine": 236,
    "content": "def parse_joins(self, sql: str) -> List[JoinInfo]:\n        \"\"\"JOIN Ï†à ÌååÏã±\"\"\"\n        joins = []\n        \n        # JOIN Ìå®ÌÑ¥: (INNER|LEFT|RIGHT|FULL) JOIN table ON condition\n        join_pattern = r'(INNER\\s+JOIN|LEFT\\s+(?:OUTER\\s+)?JOIN|RIGHT\\s+(?:OUTER\\s+)?JOIN|FULL\\s+(?:OUTER\\s+)?JOIN|JOIN)\\s+(\\w+)(?:\\s+\\w+)?\\s+ON\\s+([^\\n]+?)(?=(?:INNER|LEFT|RIGHT|FULL|JOIN|WHERE|GROUP|ORDER|$))'\n        \n        for match in re.finditer(join_pattern, sql, re.IGNORECASE | re.DOTALL):\n            join_type = match.group(1).strip()\n            table = match.group(2).strip()\n            on_condition = match.group(3).strip()\n            \n            # ON Ï°∞Í±¥ÏóêÏÑú Í¥ÄÍ≥Ñ Ï∂îÏ∂ú\n            # Ïòà: T.route_id = R.route_id -> Trip_Log.route_id = Route_Master.route_id\n            relationship = on_condition\n            \n            joins.append(JoinInfo(\n                type=join_type,\n                table=table,\n                on_condition=on_condition,\n                relationship=relationship\n            ))\n        \n        return joins",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 384
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "sql",
    "symbolKind": "Kind(13)",
    "startLine": 213,
    "startChar": 26,
    "endLine": 213,
    "content": "def parse_joins(self, sql: str) -> List[JoinInfo]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "joins",
    "symbolKind": "Kind(13)",
    "startLine": 215,
    "startChar": 8,
    "endLine": 215,
    "content": "joins = []",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "join_pattern",
    "symbolKind": "Kind(13)",
    "startLine": 218,
    "startChar": 8,
    "endLine": 218,
    "content": "join_pattern = r'(INNER\\s+JOIN|LEFT\\s+(?:OUTER\\s+)?JOIN|RIGHT\\s+(?:OUTER\\s+)?JOIN|FULL\\s+(?:OUTER\\s+)?JOIN|JOIN)\\s+(\\w+)(?:\\s+\\w+)?\\s+ON\\s+([^\\n]+?)(?=(?:INNER|LEFT|RIGHT|FULL|JOIN|WHERE|GROUP|ORDER|$))'",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "match",
    "symbolKind": "Kind(13)",
    "startLine": 220,
    "startChar": 12,
    "endLine": 220,
    "content": "for match in re.finditer(join_pattern, sql, re.IGNORECASE | re.DOTALL):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "join_type",
    "symbolKind": "Kind(13)",
    "startLine": 221,
    "startChar": 12,
    "endLine": 221,
    "content": "join_type = match.group(1).strip()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "table",
    "symbolKind": "Kind(13)",
    "startLine": 222,
    "startChar": 12,
    "endLine": 222,
    "content": "table = match.group(2).strip()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "on_condition",
    "symbolKind": "Kind(13)",
    "startLine": 223,
    "startChar": 12,
    "endLine": 223,
    "content": "on_condition = match.group(3).strip()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "relationship",
    "symbolKind": "Kind(13)",
    "startLine": 227,
    "startChar": 12,
    "endLine": 227,
    "content": "relationship = on_condition",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "parse_where_conditions",
    "symbolKind": "Method",
    "startLine": 238,
    "startChar": 4,
    "endLine": 273,
    "content": "def parse_where_conditions(self, parsed) -> List[WhereCondition]:\n        \"\"\"WHERE Ï†à ÌååÏã±\"\"\"\n        conditions = []\n        \n        for token in parsed.tokens:\n            if isinstance(token, Where):\n                where_str = str(token)[6:].strip()  # \"WHERE \" Ï†úÍ±∞\n                \n                # ANDÎ°ú Î∂ÑÎ¶¨\n                parts = re.split(r'\\s+AND\\s+', where_str, flags=re.IGNORECASE)\n                \n                for part in parts:\n                    part = part.strip()\n                    \n                    # Ï°∞Í±¥ ÌååÏã±: column operator value\n                    # Ïòà: T.base_date = '20251219'\n                    match = re.match(r\"([\\w.]+)\\s*(=|!=|<>|>|<|>=|<=|LIKE|IN)\\s*(.+)\", part, re.IGNORECASE)\n                    \n                    if match:\n                        column = match.group(1).strip()\n                        operator = match.group(2).strip()\n                        value = match.group(3).strip()\n                        \n                        # Ï°∞Í±¥ ÌÉÄÏûÖ ÌåêÎã®\n                        cond_type = \"filter\"\n                        if \"base_date\" in column.lower() or \"partition\" in column.lower():\n                            cond_type = \"partition_key\"\n                        \n                        conditions.append(WhereCondition(\n                            column=column,\n                            operator=operator,\n                            value=value,\n                            type=cond_type\n                        ))\n        \n        return conditions",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 385
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "parsed",
    "symbolKind": "Kind(13)",
    "startLine": 238,
    "startChar": 37,
    "endLine": 238,
    "content": "def parse_where_conditions(self, parsed) -> List[WhereCondition]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "conditions",
    "symbolKind": "Kind(13)",
    "startLine": 240,
    "startChar": 8,
    "endLine": 240,
    "content": "conditions = []",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "token",
    "symbolKind": "Kind(13)",
    "startLine": 242,
    "startChar": 12,
    "endLine": 242,
    "content": "for token in parsed.tokens:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "where_str",
    "symbolKind": "Kind(13)",
    "startLine": 244,
    "startChar": 16,
    "endLine": 244,
    "content": "where_str = str(token)[6:].strip()  # \"WHERE \" Ï†úÍ±∞",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "parts",
    "symbolKind": "Kind(13)",
    "startLine": 247,
    "startChar": 16,
    "endLine": 247,
    "content": "parts = re.split(r'\\s+AND\\s+', where_str, flags=re.IGNORECASE)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "part",
    "symbolKind": "Kind(13)",
    "startLine": 249,
    "startChar": 20,
    "endLine": 249,
    "content": "for part in parts:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "match",
    "symbolKind": "Kind(13)",
    "startLine": 254,
    "startChar": 20,
    "endLine": 254,
    "content": "match = re.match(r\"([\\w.]+)\\s*(=|!=|<>|>|<|>=|<=|LIKE|IN)\\s*(.+)\", part, re.IGNORECASE)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "column",
    "symbolKind": "Kind(13)",
    "startLine": 257,
    "startChar": 24,
    "endLine": 257,
    "content": "column = match.group(1).strip()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "operator",
    "symbolKind": "Kind(13)",
    "startLine": 258,
    "startChar": 24,
    "endLine": 258,
    "content": "operator = match.group(2).strip()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "value",
    "symbolKind": "Kind(13)",
    "startLine": 259,
    "startChar": 24,
    "endLine": 259,
    "content": "value = match.group(3).strip()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "cond_type",
    "symbolKind": "Kind(13)",
    "startLine": 262,
    "startChar": 24,
    "endLine": 262,
    "content": "cond_type = \"filter\"",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "parse_group_by",
    "symbolKind": "Method",
    "startLine": 275,
    "startChar": 4,
    "endLine": 281,
    "content": "def parse_group_by(self, sql: str) -> List[str]:\n        \"\"\"GROUP BY Ï†à ÌååÏã±\"\"\"\n        match = re.search(r'GROUP\\s+BY\\s+([^\\n]+?)(?=ORDER|HAVING|$)', sql, re.IGNORECASE | re.DOTALL)\n        if match:\n            group_str = match.group(1).strip()\n            return [col.strip() for col in group_str.split(',')]\n        return []",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 386
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "sql",
    "symbolKind": "Kind(13)",
    "startLine": 275,
    "startChar": 29,
    "endLine": 275,
    "content": "def parse_group_by(self, sql: str) -> List[str]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "match",
    "symbolKind": "Kind(13)",
    "startLine": 277,
    "startChar": 8,
    "endLine": 277,
    "content": "match = re.search(r'GROUP\\s+BY\\s+([^\\n]+?)(?=ORDER|HAVING|$)', sql, re.IGNORECASE | re.DOTALL)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "group_str",
    "symbolKind": "Kind(13)",
    "startLine": 279,
    "startChar": 12,
    "endLine": 279,
    "content": "group_str = match.group(1).strip()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "parse_order_by",
    "symbolKind": "Method",
    "startLine": 283,
    "startChar": 4,
    "endLine": 289,
    "content": "def parse_order_by(self, sql: str) -> List[str]:\n        \"\"\"ORDER BY Ï†à ÌååÏã±\"\"\"\n        match = re.search(r'ORDER\\s+BY\\s+([^\\n]+?)$', sql, re.IGNORECASE | re.DOTALL)\n        if match:\n            order_str = match.group(1).strip()\n            return [col.strip() for col in order_str.split(',')]\n        return []",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 387
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "sql",
    "symbolKind": "Kind(13)",
    "startLine": 283,
    "startChar": 29,
    "endLine": 283,
    "content": "def parse_order_by(self, sql: str) -> List[str]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "match",
    "symbolKind": "Kind(13)",
    "startLine": 285,
    "startChar": 8,
    "endLine": 285,
    "content": "match = re.search(r'ORDER\\s+BY\\s+([^\\n]+?)$', sql, re.IGNORECASE | re.DOTALL)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "order_str",
    "symbolKind": "Kind(13)",
    "startLine": 287,
    "startChar": 12,
    "endLine": 287,
    "content": "order_str = match.group(1).strip()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "classify_query_unit",
    "symbolKind": "Method",
    "startLine": 291,
    "startChar": 4,
    "endLine": 319,
    "content": "def classify_query_unit(self, structure: QueryStructure) -> tuple[str, str, List[str]]:\n        \"\"\"\n        ÏøºÎ¶¨Î•º unitA/B/CÎ°ú Î∂ÑÎ•ò\n        \n        Returns:\n            (unit_type, unit_description, entities)\n        \"\"\"\n        # ÌÖåÏù¥Î∏î Í∞úÏàò ÌôïÏù∏\n        tables = set()\n        tables.add(structure.from_table)\n        for join in structure.joins:\n            tables.add(join.table)\n        \n        # SELECT Ï†àÏóêÏÑú ÏóîÌã∞Ìã∞ Ï∂îÏ∂ú\n        entities = []\n        for col in structure.select_columns:\n            if col.table and col.table not in entities:\n                # ÌÖåÏù¥Î∏îÎ™ÖÏóêÏÑú ÏóîÌã∞Ìã∞Î™Ö Ï∂îÏ∂ú (Ïòà: Route_Master -> ÎÖ∏ÏÑ†)\n                entity = self._extract_entity_name(col.table)\n                if entity:\n                    entities.append(entity)\n        \n        # Î∂ÑÎ•ò Î°úÏßÅ\n        if len(tables) == 1:\n            return \"unitA\", \"Îã®Ïàú ÌÖåÏù¥Î∏î\", entities\n        elif len(tables) == 2:\n            return \"unitB\", \"ÏÉÅÏÑ∏ Ï†ïÎ≥¥\", entities\n        else:\n            return \"unitC\", f\"Î≥µÌï© Ï†ïÎ≥¥ ({' + '.join(entities)})\", entities",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 403
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "structure",
    "symbolKind": "Kind(13)",
    "startLine": 291,
    "startChar": 34,
    "endLine": 291,
    "content": "def classify_query_unit(self, structure: QueryStructure) -> tuple[str, str, List[str]]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "tables",
    "symbolKind": "Kind(13)",
    "startLine": 299,
    "startChar": 8,
    "endLine": 299,
    "content": "tables = set()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "join",
    "symbolKind": "Kind(13)",
    "startLine": 301,
    "startChar": 12,
    "endLine": 301,
    "content": "for join in structure.joins:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "entities",
    "symbolKind": "Kind(13)",
    "startLine": 305,
    "startChar": 8,
    "endLine": 305,
    "content": "entities = []",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "col",
    "symbolKind": "Kind(13)",
    "startLine": 306,
    "startChar": 12,
    "endLine": 306,
    "content": "for col in structure.select_columns:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "entity",
    "symbolKind": "Kind(13)",
    "startLine": 309,
    "startChar": 16,
    "endLine": 309,
    "content": "entity = self._extract_entity_name(col.table)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "_extract_entity_name",
    "symbolKind": "Method",
    "startLine": 321,
    "startChar": 4,
    "endLine": 331,
    "content": "def _extract_entity_name(self, table_name: str) -> str:\n        \"\"\"ÌÖåÏù¥Î∏îÎ™ÖÏóêÏÑú ÏóîÌã∞Ìã∞Î™Ö Ï∂îÏ∂ú\"\"\"\n        # Í∞ÑÎã®Ìïú Îß§Ìïë (Ïã§Ï†úÎ°úÎäî DictionaryÏóêÏÑú Í∞ÄÏ†∏ÏôÄÏïº Ìï®)\n        entity_map = {\n            \"Route_Master\": \"ÎÖ∏ÏÑ†\",\n            \"Station_Master\": \"Ï†ïÎ•òÏû•\",\n            \"Trip_Log\": \"Ïù¥Ïö©\",\n            \"Bus_Master\": \"Î≤ÑÏä§\",\n            \"Driver_Master\": \"Í∏∞ÏÇ¨\"\n        }\n        return entity_map.get(table_name, table_name)",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 309
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "table_name",
    "symbolKind": "Kind(13)",
    "startLine": 321,
    "startChar": 35,
    "endLine": 321,
    "content": "def _extract_entity_name(self, table_name: str) -> str:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "entity_map",
    "symbolKind": "Kind(13)",
    "startLine": 324,
    "startChar": 8,
    "endLine": 324,
    "content": "entity_map = {",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "infer_presentation_type",
    "symbolKind": "Method",
    "startLine": 333,
    "startChar": 4,
    "endLine": 355,
    "content": "def infer_presentation_type(self, structure: QueryStructure) -> Dict[str, Any]:\n        \"\"\"Presentation ÌÉÄÏûÖ Ï∂îÎ°†\"\"\"\n        # ÏßëÍ≥Ñ Ìï®ÏàòÍ∞Ä ÏûàÍ≥† GROUP BYÍ∞Ä ÏûàÏúºÎ©¥ Ï∞®Ìä∏\n        has_aggregation = any(col.aggregation for col in structure.select_columns)\n        has_group_by = len(structure.group_by) > 0\n        \n        if has_aggregation and has_group_by:\n            # Ï≤´ Î≤àÏß∏ GROUP BY Ïª¨ÎüºÏùÑ xÏ∂ïÏúºÎ°ú\n            x_col = structure.select_columns[0] if structure.select_columns else None\n            # ÏßëÍ≥Ñ Ïª¨ÎüºÏùÑ yÏ∂ïÏúºÎ°ú\n            y_col = next((col for col in structure.select_columns if col.aggregation), None)\n            \n            return {\n                \"chart_type\": \"bar\",\n                \"x_axis\": x_col.alias if x_col else \"category\",\n                \"y_axis\": y_col.alias if y_col else \"value\",\n                \"title\": \"ÏßëÍ≥Ñ Í≤∞Í≥º\"\n            }\n        else:\n            return {\n                \"chart_type\": \"table\",\n                \"title\": \"Ï°∞Ìöå Í≤∞Í≥º\"\n            }",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 406
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "structure",
    "symbolKind": "Kind(13)",
    "startLine": 333,
    "startChar": 38,
    "endLine": 333,
    "content": "def infer_presentation_type(self, structure: QueryStructure) -> Dict[str, Any]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "has_aggregation",
    "symbolKind": "Kind(13)",
    "startLine": 336,
    "startChar": 8,
    "endLine": 336,
    "content": "has_aggregation = any(col.aggregation for col in structure.select_columns)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "has_group_by",
    "symbolKind": "Kind(13)",
    "startLine": 337,
    "startChar": 8,
    "endLine": 337,
    "content": "has_group_by = len(structure.group_by) > 0",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "x_col",
    "symbolKind": "Kind(13)",
    "startLine": 341,
    "startChar": 12,
    "endLine": 341,
    "content": "x_col = structure.select_columns[0] if structure.select_columns else None",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "y_col",
    "symbolKind": "Kind(13)",
    "startLine": 343,
    "startChar": 12,
    "endLine": 343,
    "content": "y_col = next((col for col in structure.select_columns if col.aggregation), None)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "analyze_query",
    "symbolKind": "Method",
    "startLine": 357,
    "startChar": 4,
    "endLine": 456,
    "content": "def analyze_query(\n        self, \n        sql: str, \n        question: str = None,\n        query_id: str = None,\n        description: str = None\n    ) -> Dict[str, Any]:\n        \"\"\"\n        SQL ÏøºÎ¶¨ Î∂ÑÏÑù Î∞è JSON ÏÉùÏÑ±\n        \n        Args:\n            sql: Î∂ÑÏÑùÌï† SQL ÏøºÎ¶¨\n            question: ÏøºÎ¶¨Ïóê ÎåÄÌïú ÏßàÎ¨∏\n            query_id: ÏøºÎ¶¨ ID\n            description: ÏøºÎ¶¨ ÏÑ§Î™Ö\n            \n        Returns:\n            Î∂ÑÏÑù Í≤∞Í≥º ÎîïÏÖîÎÑàÎ¶¨\n        \"\"\"\n        # SQL ÌååÏã±\n        parsed = sqlparse.parse(sql)[0]\n        \n        # Ï†ïÍ∑úÌôîÎêú SQL\n        normalized_sql = self.normalize_sql(sql)\n        \n        # Íµ¨Ï°∞ ÌååÏã±\n        select_columns = self.parse_select_columns(parsed)\n        joins = self.parse_joins(sql)\n        where_conditions = self.parse_where_conditions(parsed)\n        group_by = self.parse_group_by(sql)\n        order_by = self.parse_order_by(sql)\n        \n        # FROM ÌÖåÏù¥Î∏î Ï∂îÏ∂ú\n        from_match = re.search(r'FROM\\s+(\\w+)', sql, re.IGNORECASE)\n        from_table = from_match.group(1) if from_match else \"Unknown\"\n        \n        structure = QueryStructure(\n            select_columns=select_columns,\n            from_table=from_table,\n            joins=joins,\n            where_conditions=where_conditions,\n            group_by=group_by,\n            order_by=order_by\n        )\n        \n        # ÏøºÎ¶¨ Î∂ÑÎ•ò\n        unit_type, unit_desc, entities = self.classify_query_unit(structure)\n        \n        # Presentation ÌÉÄÏûÖ Ï∂îÎ°†\n        presentation_config = self.infer_presentation_type(structure)\n        \n        # JOIN Í∑∏ÎûòÌîÑ ÏÉùÏÑ±\n        join_graph = []\n        for join in joins:\n            join_graph.append(f\"{from_table} -> {join.table} ({join.on_condition})\")\n        \n        # ÏàòÏ†ï Í∞ÄÎä•Ìïú ÌååÎùºÎØ∏ÌÑ∞ Ï∂îÏ∂ú\n        modifiable_params = [cond.column.split('.')[-1] for cond in where_conditions]\n        \n        # JSON Í≤∞Í≥º ÏÉùÏÑ±\n        result = {\n            \"query_id\": query_id or f\"q_{datetime.now().strftime('%Y%m%d%H%M%S')}\",\n            \"question\": question or \"ÏßàÎ¨∏ ÏóÜÏùå\",\n            \"description\": description or \"ÏÑ§Î™Ö ÏóÜÏùå\",\n            \"unit_type\": unit_type,\n            \"unit_description\": unit_desc,\n            \"entities\": entities,\n            \"presentation_type\": \"table_with_chart\" if presentation_config[\"chart_type\"] != \"table\" else \"table\",\n            \"presentation_config\": presentation_config,\n            \"sql\": {\n                \"original\": sql,\n                \"normalized\": normalized_sql,\n                \"structure\": {\n                    \"select_columns\": [asdict(col) for col in select_columns],\n                    \"from_table\": from_table,\n                    \"joins\": [asdict(join) for join in joins],\n                    \"where_conditions\": [asdict(cond) for cond in where_conditions],\n                    \"group_by\": group_by,\n                    \"order_by\": order_by\n                }\n            },\n            \"relationships\": {\n                \"fixed\": True,\n                \"description\": f\"{from_table}Î•º Ï§ëÏã¨ÏúºÎ°ú {', '.join([j.table for j in joins])}Î•º Ï°∞Ïù∏\",\n                \"join_graph\": join_graph\n            },\n            \"parameters\": {\n                \"modifiable\": modifiable_params,\n                \"fixed\": [\"joins\", \"select_columns\", \"group_by\"],\n                \"template\": question.replace(' ', '_') if question else \"custom_query\"\n            },\n            \"metadata\": {\n                \"created_at\": datetime.now().isoformat(),\n                \"tags\": entities,\n                \"complexity\": \"low\" if unit_type == \"unitA\" else (\"medium\" if unit_type == \"unitB\" else \"high\"),\n                \"estimated_rows\": \"< 100\" if len(where_conditions) > 0 else \"unknown\"\n            }\n        }\n        \n        return result",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 486
      },
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 528
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "sql",
    "symbolKind": "Kind(13)",
    "startLine": 359,
    "startChar": 8,
    "endLine": 359,
    "content": "sql: str,",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "question",
    "symbolKind": "Kind(13)",
    "startLine": 360,
    "startChar": 8,
    "endLine": 360,
    "content": "question: str = None,",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "query_id",
    "symbolKind": "Kind(13)",
    "startLine": 361,
    "startChar": 8,
    "endLine": 361,
    "content": "query_id: str = None,",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "description",
    "symbolKind": "Kind(13)",
    "startLine": 362,
    "startChar": 8,
    "endLine": 362,
    "content": "description: str = None",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "parsed",
    "symbolKind": "Kind(13)",
    "startLine": 377,
    "startChar": 8,
    "endLine": 377,
    "content": "parsed = sqlparse.parse(sql)[0]",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "normalized_sql",
    "symbolKind": "Kind(13)",
    "startLine": 380,
    "startChar": 8,
    "endLine": 380,
    "content": "normalized_sql = self.normalize_sql(sql)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "select_columns",
    "symbolKind": "Kind(13)",
    "startLine": 383,
    "startChar": 8,
    "endLine": 383,
    "content": "select_columns = self.parse_select_columns(parsed)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "joins",
    "symbolKind": "Kind(13)",
    "startLine": 384,
    "startChar": 8,
    "endLine": 384,
    "content": "joins = self.parse_joins(sql)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "where_conditions",
    "symbolKind": "Kind(13)",
    "startLine": 385,
    "startChar": 8,
    "endLine": 385,
    "content": "where_conditions = self.parse_where_conditions(parsed)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "group_by",
    "symbolKind": "Kind(13)",
    "startLine": 386,
    "startChar": 8,
    "endLine": 386,
    "content": "group_by = self.parse_group_by(sql)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "order_by",
    "symbolKind": "Kind(13)",
    "startLine": 387,
    "startChar": 8,
    "endLine": 387,
    "content": "order_by = self.parse_order_by(sql)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "from_match",
    "symbolKind": "Kind(13)",
    "startLine": 390,
    "startChar": 8,
    "endLine": 390,
    "content": "from_match = re.search(r'FROM\\s+(\\w+)', sql, re.IGNORECASE)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "from_table",
    "symbolKind": "Kind(13)",
    "startLine": 391,
    "startChar": 8,
    "endLine": 391,
    "content": "from_table = from_match.group(1) if from_match else \"Unknown\"",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "structure",
    "symbolKind": "Kind(13)",
    "startLine": 393,
    "startChar": 8,
    "endLine": 393,
    "content": "structure = QueryStructure(",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "unit_type",
    "symbolKind": "Kind(13)",
    "startLine": 403,
    "startChar": 8,
    "endLine": 403,
    "content": "unit_type, unit_desc, entities = self.classify_query_unit(structure)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "unit_desc",
    "symbolKind": "Kind(13)",
    "startLine": 403,
    "startChar": 19,
    "endLine": 403,
    "content": "unit_type, unit_desc, entities = self.classify_query_unit(structure)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "entities",
    "symbolKind": "Kind(13)",
    "startLine": 403,
    "startChar": 30,
    "endLine": 403,
    "content": "unit_type, unit_desc, entities = self.classify_query_unit(structure)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "presentation_config",
    "symbolKind": "Kind(13)",
    "startLine": 406,
    "startChar": 8,
    "endLine": 406,
    "content": "presentation_config = self.infer_presentation_type(structure)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "join_graph",
    "symbolKind": "Kind(13)",
    "startLine": 409,
    "startChar": 8,
    "endLine": 409,
    "content": "join_graph = []",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "join",
    "symbolKind": "Kind(13)",
    "startLine": 410,
    "startChar": 12,
    "endLine": 410,
    "content": "for join in joins:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "modifiable_params",
    "symbolKind": "Kind(13)",
    "startLine": 414,
    "startChar": 8,
    "endLine": 414,
    "content": "modifiable_params = [cond.column.split('.')[-1] for cond in where_conditions]",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "result",
    "symbolKind": "Kind(13)",
    "startLine": 417,
    "startChar": 8,
    "endLine": 417,
    "content": "result = {",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "save_to_json",
    "symbolKind": "Method",
    "startLine": 458,
    "startChar": 4,
    "endLine": 469,
    "content": "def save_to_json(self, result: Dict[str, Any], filename: str = None) -> str:\n        \"\"\"Î∂ÑÏÑù Í≤∞Í≥ºÎ•º JSON ÌååÏùºÎ°ú Ï†ÄÏû•\"\"\"\n        if filename is None:\n            filename = f\"query_{result['query_id']}.json\"\n        \n        filepath = os.path.join(self.data_dir, filename)\n        \n        with open(filepath, 'w', encoding='utf-8') as f:\n            json.dump(result, f, indent=2, ensure_ascii=False)\n        \n        print(f\"‚úÖ JSON Ï†ÄÏû• ÏôÑÎ£å: {filepath}\")\n        return filepath",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 496
      },
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
        "startLine": 536
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "result",
    "symbolKind": "Kind(13)",
    "startLine": 458,
    "startChar": 27,
    "endLine": 458,
    "content": "def save_to_json(self, result: Dict[str, Any], filename: str = None) -> str:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "filename",
    "symbolKind": "Kind(13)",
    "startLine": 458,
    "startChar": 51,
    "endLine": 458,
    "content": "def save_to_json(self, result: Dict[str, Any], filename: str = None) -> str:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "filepath",
    "symbolKind": "Kind(13)",
    "startLine": 463,
    "startChar": 8,
    "endLine": 463,
    "content": "filepath = os.path.join(self.data_dir, filename)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "f",
    "symbolKind": "Kind(13)",
    "startLine": 465,
    "startChar": 54,
    "endLine": 465,
    "content": "with open(filepath, 'w', encoding='utf-8') as f:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "batch_analyze",
    "symbolKind": "Method",
    "startLine": 471,
    "startChar": 4,
    "endLine": 506,
    "content": "def batch_analyze(self, queries: List[Dict[str, str]]) -> List[Dict[str, Any]]:\n        \"\"\"\n        Ïó¨Îü¨ ÏøºÎ¶¨Î•º ÏùºÍ¥Ñ Î∂ÑÏÑù\n        \n        Args:\n            queries: [{\"sql\": \"...\", \"question\": \"...\", \"query_id\": \"...\"}, ...]\n            \n        Returns:\n            Î∂ÑÏÑù Í≤∞Í≥º Î¶¨Ïä§Ìä∏\n        \"\"\"\n        results = []\n        \n        for query_info in queries:\n            print(f\"\\nüîç Î∂ÑÏÑù Ï§ë: {query_info.get('question', 'Unknown')}\")\n            \n            result = self.analyze_query(\n                sql=query_info['sql'],\n                question=query_info.get('question'),\n                query_id=query_info.get('query_id'),\n                description=query_info.get('description')\n            )\n            \n            results.append(result)\n            \n            # Í∞úÎ≥Ñ JSON ÌååÏùºÎ°ú Ï†ÄÏû•\n            self.save_to_json(result)\n        \n        # Ï†ÑÏ≤¥ Í≤∞Í≥ºÎèÑ ÌïòÎÇòÏùò ÌååÏùºÎ°ú Ï†ÄÏû•\n        all_results_path = os.path.join(self.data_dir, \"all_queries.json\")\n        with open(all_results_path, 'w', encoding='utf-8') as f:\n            json.dump(results, f, indent=2, ensure_ascii=False)\n        \n        print(f\"\\n‚ú® Ï†ÑÏ≤¥ Î∂ÑÏÑù ÏôÑÎ£å! Ï¥ù {len(results)}Í∞ú ÏøºÎ¶¨ Î∂ÑÏÑùÎê®\")\n        print(f\"üìÅ Ï†ÑÏ≤¥ Í≤∞Í≥º: {all_results_path}\")\n        \n        return results",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "queries",
    "symbolKind": "Kind(13)",
    "startLine": 471,
    "startChar": 28,
    "endLine": 471,
    "content": "def batch_analyze(self, queries: List[Dict[str, str]]) -> List[Dict[str, Any]]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "results",
    "symbolKind": "Kind(13)",
    "startLine": 481,
    "startChar": 8,
    "endLine": 481,
    "content": "results = []",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "query_info",
    "symbolKind": "Kind(13)",
    "startLine": 483,
    "startChar": 12,
    "endLine": 483,
    "content": "for query_info in queries:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "result",
    "symbolKind": "Kind(13)",
    "startLine": 486,
    "startChar": 12,
    "endLine": 486,
    "content": "result = self.analyze_query(",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "all_results_path",
    "symbolKind": "Kind(13)",
    "startLine": 499,
    "startChar": 8,
    "endLine": 499,
    "content": "all_results_path = os.path.join(self.data_dir, \"all_queries.json\")",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "f",
    "symbolKind": "Kind(13)",
    "startLine": 500,
    "startChar": 62,
    "endLine": 500,
    "content": "with open(all_results_path, 'w', encoding='utf-8') as f:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "data_dir",
    "symbolKind": "Kind(13)",
    "startLine": 72,
    "startChar": 17,
    "endLine": 72,
    "content": "self.data_dir = os.path.join(project_root, \"data\")",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "analyzer",
    "symbolKind": "Kind(13)",
    "startLine": 511,
    "startChar": 4,
    "endLine": 511,
    "content": "analyzer = SQLQueryAnalyzer()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "example_query",
    "symbolKind": "Kind(13)",
    "startLine": 514,
    "startChar": 4,
    "endLine": 514,
    "content": "example_query = \"\"\"",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/sql_json_result.py",
    "symbolName": "result",
    "symbolKind": "Kind(13)",
    "startLine": 528,
    "startChar": 4,
    "endLine": 528,
    "content": "result = analyzer.analyze_query(",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "QueryModifier",
    "symbolKind": "Class",
    "startLine": 15,
    "startChar": 0,
    "endLine": 230,
    "content": "class QueryModifier:\n    \"\"\"\n    ÏøºÎ¶¨ ÏàòÏ†ï ÎèÑÍµ¨\n    - WHERE Ï°∞Í±¥Îßå ÏàòÏ†ï Í∞ÄÎä•\n    - JOIN, SELECT Ï†àÏùÄ Í≥†Ï†ï\n    \"\"\"\n    \n    def __init__(self, data_dir: str = None):\n        if data_dir is None:\n            project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))\n            self.data_dir = os.path.join(project_root, \"data\")\n        else:\n            self.data_dir = data_dir\n    \n    def load_query(self, query_id: str) -> Optional[Dict[str, Any]]:\n        \"\"\"Ï†ÄÏû•Îêú ÏøºÎ¶¨ JSON Î°úÎìú\"\"\"\n        filepath = os.path.join(self.data_dir, f\"query_{query_id}.json\")\n        \n        if not os.path.exists(filepath):\n            print(f\"‚ùå ÏøºÎ¶¨Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§: {query_id}\")\n            return None\n        \n        with open(filepath, 'r', encoding='utf-8') as f:\n            return json.load(f)\n    \n    def modify_where_conditions(\n        self, \n        query_data: Dict[str, Any], \n        new_conditions: List[Dict[str, str]]\n    ) -> Dict[str, Any]:\n        \"\"\"\n        WHERE Ï°∞Í±¥ ÏàòÏ†ï\n        \n        Args:\n            query_data: ÏõêÎ≥∏ ÏøºÎ¶¨ Îç∞Ïù¥ÌÑ∞\n            new_conditions: ÏÉàÎ°úÏö¥ Ï°∞Í±¥ Î¶¨Ïä§Ìä∏\n                [{\"column\": \"Trip_Log.base_date\", \"operator\": \"=\", \"value\": \"'20251220'\", \"type\": \"filter\"}, ...]\n        \n        Returns:\n            ÏàòÏ†ïÎêú ÏøºÎ¶¨ Îç∞Ïù¥ÌÑ∞\n        \"\"\"\n        # Í∏∞Ï°¥ Íµ¨Ï°∞ Î≥µÏÇ¨\n        modified = query_data.copy()\n        \n        # WHERE Ï°∞Í±¥ ÏóÖÎç∞Ïù¥Ìä∏\n        modified['sql']['structure']['where_conditions'] = new_conditions\n        \n        # SQL Ïû¨ÏÉùÏÑ±\n        modified['sql']['normalized'] = self._rebuild_sql(modified['sql']['structure'])\n        \n        # Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏\n        modified['metadata']['modified_at'] = datetime.now().isoformat()\n        modified['metadata']['modification_count'] = modified['metadata'].get('modification_count', 0) + 1\n        \n        # ÏàòÏ†ï Í∞ÄÎä•Ìïú ÌååÎùºÎØ∏ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏\n        modified['parameters']['modifiable'] = [\n            cond['column'].split('.')[-1] for cond in new_conditions\n        ]\n        \n        return modified\n    \n    def _rebuild_sql(self, structure: Dict[str, Any]) -> str:\n        \"\"\"Íµ¨Ï°∞ Ï†ïÎ≥¥Î°úÎ∂ÄÌÑ∞ SQL Ïû¨ÏÉùÏÑ±\"\"\"\n        # SELECT Ï†à\n        select_parts = []\n        for col in structure['select_columns']:\n            expr = col['expression']\n            alias = col['alias']\n            if alias and alias != col.get('column', ''):\n                select_parts.append(f\"{expr} AS '{alias}'\")\n            else:\n                select_parts.append(expr)\n        \n        sql = f\"SELECT \\n    {', '.join(select_parts)}\\n\"\n        \n        # FROM Ï†à\n        sql += f\"FROM {structure['from_table']}\\n\"\n        \n        # JOIN Ï†à\n        for join in structure['joins']:\n            sql += f\"{join['type']} {join['table']} ON {join['on_condition']}\\n\"\n        \n        # WHERE Ï†à\n        if structure['where_conditions']:\n            where_parts = []\n            for cond in structure['where_conditions']:\n                where_parts.append(f\"{cond['column']} {cond['operator']} {cond['value']}\")\n            sql += f\"WHERE {' AND '.join(where_parts)}\\n\"\n        \n        # GROUP BY Ï†à\n        if structure.get('group_by'):\n            sql += f\"GROUP BY {', '.join(structure['group_by'])}\\n\"\n        \n        # ORDER BY Ï†à\n        if structure.get('order_by'):\n            sql += f\"ORDER BY {', '.join(structure['order_by'])}\\n\"\n        \n        return sql.strip()\n    \n    def save_modified_query(\n        self, \n        modified_data: Dict[str, Any], \n        new_query_id: str = None\n    ) -> str:\n        \"\"\"ÏàòÏ†ïÎêú ÏøºÎ¶¨ Ï†ÄÏû•\"\"\"\n        if new_query_id:\n            modified_data['query_id'] = new_query_id\n        \n        filename = f\"query_{modified_data['query_id']}.json\"\n        filepath = os.path.join(self.data_dir, filename)\n        \n        with open(filepath, 'w', encoding='utf-8') as f:\n            json.dump(modified_data, f, indent=2, ensure_ascii=False)\n        \n        print(f\"‚úÖ ÏàòÏ†ïÎêú ÏøºÎ¶¨ Ï†ÄÏû•: {filepath}\")\n        return filepath\n    \n    def parse_user_request(self, user_request: str, current_conditions: List[Dict]) -> List[Dict[str, str]]:\n        \"\"\"\n        ÏÇ¨Ïö©Ïûê ÏöîÏ≤≠ÏùÑ ÌååÏã±ÌïòÏó¨ WHERE Ï°∞Í±¥ÏúºÎ°ú Î≥ÄÌôò\n        \n        Ïòà:\n        - \"ÎÇ†ÏßúÎ•º 20251220ÏúºÎ°ú Î≥ÄÍ≤ΩÌï¥Ï§ò\" -> base_date = '20251220'\n        - \"ÎÖ∏ÏÑ†ÏùÑ 150Î≤àÏúºÎ°ú Î∞îÍøîÏ§ò\" -> route_nm = '150'\n        \"\"\"\n        new_conditions = current_conditions.copy()\n        \n        # ÎÇ†Ïßú Î≥ÄÍ≤Ω Ìå®ÌÑ¥\n        date_match = re.search(r'ÎÇ†Ïßú.*?(\\d{8})', user_request)\n        if date_match:\n            new_date = date_match.group(1)\n            for cond in new_conditions:\n                if 'base_date' in cond['column']:\n                    cond['value'] = f\"'{new_date}'\"\n                    print(f\"  üìÖ ÎÇ†Ïßú Î≥ÄÍ≤Ω: {new_date}\")\n        \n        # ÎÖ∏ÏÑ† Î≥ÄÍ≤Ω Ìå®ÌÑ¥\n        route_match = re.search(r'ÎÖ∏ÏÑ†.*?(\\d+)', user_request)\n        if route_match:\n            new_route = route_match.group(1)\n            for cond in new_conditions:\n                if 'route_nm' in cond['column']:\n                    cond['value'] = f\"'{new_route}'\"\n                    print(f\"  üöå ÎÖ∏ÏÑ† Î≥ÄÍ≤Ω: {new_route}\")\n        \n        # ÏùºÎ∞òÏ†ÅÏù∏ Ï°∞Í±¥ Ï∂îÍ∞Ä Ìå®ÌÑ¥: \"Ïª¨ÎüºÎ™ÖÏù¥ Í∞í\"\n        add_match = re.search(r'(\\w+)(?:Ïù¥|Í∞Ä)\\s*[\\'\"]?(\\w+)[\\'\"]?', user_request)\n        if add_match and not date_match and not route_match:\n            column = add_match.group(1)\n            value = add_match.group(2)\n            \n            # Í∏∞Ï°¥ Ï°∞Í±¥Ïóê ÏóÜÏúºÎ©¥ Ï∂îÍ∞Ä\n            column_exists = any(column in cond['column'] for cond in new_conditions)\n            if not column_exists:\n                # ÌÖåÏù¥Î∏îÎ™Ö Ï∂îÎ°† (Í∞ÑÎã®Ìïú ÏòàÏãú)\n                table = self._infer_table_name(column)\n                new_conditions.append({\n                    \"column\": f\"{table}.{column}\",\n                    \"operator\": \"=\",\n                    \"value\": f\"'{value}'\",\n                    \"type\": \"filter\"\n                })\n                print(f\"  ‚ûï Ï°∞Í±¥ Ï∂îÍ∞Ä: {column} = {value}\")\n        \n        return new_conditions\n    \n    def _infer_table_name(self, column: str) -> str:\n        \"\"\"Ïª¨ÎüºÎ™ÖÏúºÎ°úÎ∂ÄÌÑ∞ ÌÖåÏù¥Î∏îÎ™Ö Ï∂îÎ°† (Í∞ÑÎã®Ìïú Îß§Ìïë)\"\"\"\n        column_table_map = {\n            \"base_date\": \"Trip_Log\",\n            \"route_nm\": \"Route_Master\",\n            \"station_nm\": \"Station_Master\",\n            \"trip_id\": \"Trip_Log\"\n        }\n        return column_table_map.get(column, \"Unknown\")\n    \n    def interactive_modify(self, query_id: str, user_request: str) -> Optional[Dict[str, Any]]:\n        \"\"\"\n        ÎåÄÌôîÌòï ÏøºÎ¶¨ ÏàòÏ†ï\n        \n        Args:\n            query_id: ÏàòÏ†ïÌï† ÏøºÎ¶¨ ID\n            user_request: ÏÇ¨Ïö©Ïûê ÏöîÏ≤≠ (Ïòà: \"ÎÇ†ÏßúÎ•º 20251220ÏúºÎ°ú Î≥ÄÍ≤ΩÌï¥Ï§ò\")\n        \n        Returns:\n            ÏàòÏ†ïÎêú ÏøºÎ¶¨ Îç∞Ïù¥ÌÑ∞\n        \"\"\"\n        # 1. Í∏∞Ï°¥ ÏøºÎ¶¨ Î°úÎìú\n        query_data = self.load_query(query_id)\n        if not query_data:\n            return None\n        \n        print(f\"\\nüìã ÏõêÎ≥∏ ÏøºÎ¶¨: {query_data['question']}\")\n        print(f\"   SQL: {query_data['sql']['normalized'][:100]}...\")\n        \n        # 2. ÌòÑÏû¨ WHERE Ï°∞Í±¥ ÌôïÏù∏\n        current_conditions = query_data['sql']['structure']['where_conditions']\n        print(f\"\\nüîç ÌòÑÏû¨ Ï°∞Í±¥:\")\n        for cond in current_conditions:\n            print(f\"   - {cond['column']} {cond['operator']} {cond['value']}\")\n        \n        # 3. ÏÇ¨Ïö©Ïûê ÏöîÏ≤≠ ÌååÏã±\n        print(f\"\\nüí¨ ÏÇ¨Ïö©Ïûê ÏöîÏ≤≠: {user_request}\")\n        new_conditions = self.parse_user_request(user_request, current_conditions)\n        \n        # 4. ÏøºÎ¶¨ ÏàòÏ†ï\n        modified_data = self.modify_where_conditions(query_data, new_conditions)\n        \n        print(f\"\\n‚ú® ÏàòÏ†ïÎêú Ï°∞Í±¥:\")\n        for cond in new_conditions:\n            print(f\"   - {cond['column']} {cond['operator']} {cond['value']}\")\n        \n        print(f\"\\nüìù ÏàòÏ†ïÎêú SQL:\")\n        print(modified_data['sql']['normalized'])\n        \n        return modified_data",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "__init__",
    "symbolKind": "Method",
    "startLine": 22,
    "startChar": 4,
    "endLine": 27,
    "content": "def __init__(self, data_dir: str = None):\n        if data_dir is None:\n            project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))\n            self.data_dir = os.path.join(project_root, \"data\")\n        else:\n            self.data_dir = data_dir",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "data_dir",
    "symbolKind": "Kind(13)",
    "startLine": 22,
    "startChar": 23,
    "endLine": 22,
    "content": "def __init__(self, data_dir: str = None):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "project_root",
    "symbolKind": "Kind(13)",
    "startLine": 24,
    "startChar": 12,
    "endLine": 24,
    "content": "project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "load_query",
    "symbolKind": "Method",
    "startLine": 29,
    "startChar": 4,
    "endLine": 38,
    "content": "def load_query(self, query_id: str) -> Optional[Dict[str, Any]]:\n        \"\"\"Ï†ÄÏû•Îêú ÏøºÎ¶¨ JSON Î°úÎìú\"\"\"\n        filepath = os.path.join(self.data_dir, f\"query_{query_id}.json\")\n        \n        if not os.path.exists(filepath):\n            print(f\"‚ùå ÏøºÎ¶¨Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§: {query_id}\")\n            return None\n        \n        with open(filepath, 'r', encoding='utf-8') as f:\n            return json.load(f)",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
        "startLine": 203
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "query_id",
    "symbolKind": "Kind(13)",
    "startLine": 29,
    "startChar": 25,
    "endLine": 29,
    "content": "def load_query(self, query_id: str) -> Optional[Dict[str, Any]]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "filepath",
    "symbolKind": "Kind(13)",
    "startLine": 31,
    "startChar": 8,
    "endLine": 31,
    "content": "filepath = os.path.join(self.data_dir, f\"query_{query_id}.json\")",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "f",
    "symbolKind": "Kind(13)",
    "startLine": 37,
    "startChar": 54,
    "endLine": 37,
    "content": "with open(filepath, 'r', encoding='utf-8') as f:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "modify_where_conditions",
    "symbolKind": "Method",
    "startLine": 40,
    "startChar": 4,
    "endLine": 74,
    "content": "def modify_where_conditions(\n        self, \n        query_data: Dict[str, Any], \n        new_conditions: List[Dict[str, str]]\n    ) -> Dict[str, Any]:\n        \"\"\"\n        WHERE Ï°∞Í±¥ ÏàòÏ†ï\n        \n        Args:\n            query_data: ÏõêÎ≥∏ ÏøºÎ¶¨ Îç∞Ïù¥ÌÑ∞\n            new_conditions: ÏÉàÎ°úÏö¥ Ï°∞Í±¥ Î¶¨Ïä§Ìä∏\n                [{\"column\": \"Trip_Log.base_date\", \"operator\": \"=\", \"value\": \"'20251220'\", \"type\": \"filter\"}, ...]\n        \n        Returns:\n            ÏàòÏ†ïÎêú ÏøºÎ¶¨ Îç∞Ïù¥ÌÑ∞\n        \"\"\"\n        # Í∏∞Ï°¥ Íµ¨Ï°∞ Î≥µÏÇ¨\n        modified = query_data.copy()\n        \n        # WHERE Ï°∞Í±¥ ÏóÖÎç∞Ïù¥Ìä∏\n        modified['sql']['structure']['where_conditions'] = new_conditions\n        \n        # SQL Ïû¨ÏÉùÏÑ±\n        modified['sql']['normalized'] = self._rebuild_sql(modified['sql']['structure'])\n        \n        # Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏\n        modified['metadata']['modified_at'] = datetime.now().isoformat()\n        modified['metadata']['modification_count'] = modified['metadata'].get('modification_count', 0) + 1\n        \n        # ÏàòÏ†ï Í∞ÄÎä•Ìïú ÌååÎùºÎØ∏ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏\n        modified['parameters']['modifiable'] = [\n            cond['column'].split('.')[-1] for cond in new_conditions\n        ]\n        \n        return modified",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
        "startLine": 221
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "query_data",
    "symbolKind": "Kind(13)",
    "startLine": 42,
    "startChar": 8,
    "endLine": 42,
    "content": "query_data: Dict[str, Any],",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "new_conditions",
    "symbolKind": "Kind(13)",
    "startLine": 43,
    "startChar": 8,
    "endLine": 43,
    "content": "new_conditions: List[Dict[str, str]]",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "modified",
    "symbolKind": "Kind(13)",
    "startLine": 57,
    "startChar": 8,
    "endLine": 57,
    "content": "modified = query_data.copy()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "_rebuild_sql",
    "symbolKind": "Method",
    "startLine": 76,
    "startChar": 4,
    "endLine": 112,
    "content": "def _rebuild_sql(self, structure: Dict[str, Any]) -> str:\n        \"\"\"Íµ¨Ï°∞ Ï†ïÎ≥¥Î°úÎ∂ÄÌÑ∞ SQL Ïû¨ÏÉùÏÑ±\"\"\"\n        # SELECT Ï†à\n        select_parts = []\n        for col in structure['select_columns']:\n            expr = col['expression']\n            alias = col['alias']\n            if alias and alias != col.get('column', ''):\n                select_parts.append(f\"{expr} AS '{alias}'\")\n            else:\n                select_parts.append(expr)\n        \n        sql = f\"SELECT \\n    {', '.join(select_parts)}\\n\"\n        \n        # FROM Ï†à\n        sql += f\"FROM {structure['from_table']}\\n\"\n        \n        # JOIN Ï†à\n        for join in structure['joins']:\n            sql += f\"{join['type']} {join['table']} ON {join['on_condition']}\\n\"\n        \n        # WHERE Ï†à\n        if structure['where_conditions']:\n            where_parts = []\n            for cond in structure['where_conditions']:\n                where_parts.append(f\"{cond['column']} {cond['operator']} {cond['value']}\")\n            sql += f\"WHERE {' AND '.join(where_parts)}\\n\"\n        \n        # GROUP BY Ï†à\n        if structure.get('group_by'):\n            sql += f\"GROUP BY {', '.join(structure['group_by'])}\\n\"\n        \n        # ORDER BY Ï†à\n        if structure.get('order_by'):\n            sql += f\"ORDER BY {', '.join(structure['order_by'])}\\n\"\n        \n        return sql.strip()",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
        "startLine": 63
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "structure",
    "symbolKind": "Kind(13)",
    "startLine": 76,
    "startChar": 27,
    "endLine": 76,
    "content": "def _rebuild_sql(self, structure: Dict[str, Any]) -> str:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "select_parts",
    "symbolKind": "Kind(13)",
    "startLine": 79,
    "startChar": 8,
    "endLine": 79,
    "content": "select_parts = []",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "col",
    "symbolKind": "Kind(13)",
    "startLine": 80,
    "startChar": 12,
    "endLine": 80,
    "content": "for col in structure['select_columns']:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "expr",
    "symbolKind": "Kind(13)",
    "startLine": 81,
    "startChar": 12,
    "endLine": 81,
    "content": "expr = col['expression']",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "alias",
    "symbolKind": "Kind(13)",
    "startLine": 82,
    "startChar": 12,
    "endLine": 82,
    "content": "alias = col['alias']",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "sql",
    "symbolKind": "Kind(13)",
    "startLine": 88,
    "startChar": 8,
    "endLine": 88,
    "content": "sql = f\"SELECT \\n    {', '.join(select_parts)}\\n\"",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "join",
    "symbolKind": "Kind(13)",
    "startLine": 94,
    "startChar": 12,
    "endLine": 94,
    "content": "for join in structure['joins']:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "where_parts",
    "symbolKind": "Kind(13)",
    "startLine": 99,
    "startChar": 12,
    "endLine": 99,
    "content": "where_parts = []",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "cond",
    "symbolKind": "Kind(13)",
    "startLine": 100,
    "startChar": 16,
    "endLine": 100,
    "content": "for cond in structure['where_conditions']:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "save_modified_query",
    "symbolKind": "Method",
    "startLine": 114,
    "startChar": 4,
    "endLine": 130,
    "content": "def save_modified_query(\n        self, \n        modified_data: Dict[str, Any], \n        new_query_id: str = None\n    ) -> str:\n        \"\"\"ÏàòÏ†ïÎêú ÏøºÎ¶¨ Ï†ÄÏû•\"\"\"\n        if new_query_id:\n            modified_data['query_id'] = new_query_id\n        \n        filename = f\"query_{modified_data['query_id']}.json\"\n        filepath = os.path.join(self.data_dir, filename)\n        \n        with open(filepath, 'w', encoding='utf-8') as f:\n            json.dump(modified_data, f, indent=2, ensure_ascii=False)\n        \n        print(f\"‚úÖ ÏàòÏ†ïÎêú ÏøºÎ¶¨ Ï†ÄÏû•: {filepath}\")\n        return filepath",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
        "startLine": 277
      },
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
        "startLine": 290
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "modified_data",
    "symbolKind": "Kind(13)",
    "startLine": 116,
    "startChar": 8,
    "endLine": 116,
    "content": "modified_data: Dict[str, Any],",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "new_query_id",
    "symbolKind": "Kind(13)",
    "startLine": 117,
    "startChar": 8,
    "endLine": 117,
    "content": "new_query_id: str = None",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "filename",
    "symbolKind": "Kind(13)",
    "startLine": 123,
    "startChar": 8,
    "endLine": 123,
    "content": "filename = f\"query_{modified_data['query_id']}.json\"",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "filepath",
    "symbolKind": "Kind(13)",
    "startLine": 124,
    "startChar": 8,
    "endLine": 124,
    "content": "filepath = os.path.join(self.data_dir, filename)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "f",
    "symbolKind": "Kind(13)",
    "startLine": 126,
    "startChar": 54,
    "endLine": 126,
    "content": "with open(filepath, 'w', encoding='utf-8') as f:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "parse_user_request",
    "symbolKind": "Method",
    "startLine": 132,
    "startChar": 4,
    "endLine": 179,
    "content": "def parse_user_request(self, user_request: str, current_conditions: List[Dict]) -> List[Dict[str, str]]:\n        \"\"\"\n        ÏÇ¨Ïö©Ïûê ÏöîÏ≤≠ÏùÑ ÌååÏã±ÌïòÏó¨ WHERE Ï°∞Í±¥ÏúºÎ°ú Î≥ÄÌôò\n        \n        Ïòà:\n        - \"ÎÇ†ÏßúÎ•º 20251220ÏúºÎ°ú Î≥ÄÍ≤ΩÌï¥Ï§ò\" -> base_date = '20251220'\n        - \"ÎÖ∏ÏÑ†ÏùÑ 150Î≤àÏúºÎ°ú Î∞îÍøîÏ§ò\" -> route_nm = '150'\n        \"\"\"\n        new_conditions = current_conditions.copy()\n        \n        # ÎÇ†Ïßú Î≥ÄÍ≤Ω Ìå®ÌÑ¥\n        date_match = re.search(r'ÎÇ†Ïßú.*?(\\d{8})', user_request)\n        if date_match:\n            new_date = date_match.group(1)\n            for cond in new_conditions:\n                if 'base_date' in cond['column']:\n                    cond['value'] = f\"'{new_date}'\"\n                    print(f\"  üìÖ ÎÇ†Ïßú Î≥ÄÍ≤Ω: {new_date}\")\n        \n        # ÎÖ∏ÏÑ† Î≥ÄÍ≤Ω Ìå®ÌÑ¥\n        route_match = re.search(r'ÎÖ∏ÏÑ†.*?(\\d+)', user_request)\n        if route_match:\n            new_route = route_match.group(1)\n            for cond in new_conditions:\n                if 'route_nm' in cond['column']:\n                    cond['value'] = f\"'{new_route}'\"\n                    print(f\"  üöå ÎÖ∏ÏÑ† Î≥ÄÍ≤Ω: {new_route}\")\n        \n        # ÏùºÎ∞òÏ†ÅÏù∏ Ï°∞Í±¥ Ï∂îÍ∞Ä Ìå®ÌÑ¥: \"Ïª¨ÎüºÎ™ÖÏù¥ Í∞í\"\n        add_match = re.search(r'(\\w+)(?:Ïù¥|Í∞Ä)\\s*[\\'\"]?(\\w+)[\\'\"]?', user_request)\n        if add_match and not date_match and not route_match:\n            column = add_match.group(1)\n            value = add_match.group(2)\n            \n            # Í∏∞Ï°¥ Ï°∞Í±¥Ïóê ÏóÜÏúºÎ©¥ Ï∂îÍ∞Ä\n            column_exists = any(column in cond['column'] for cond in new_conditions)\n            if not column_exists:\n                # ÌÖåÏù¥Î∏îÎ™Ö Ï∂îÎ°† (Í∞ÑÎã®Ìïú ÏòàÏãú)\n                table = self._infer_table_name(column)\n                new_conditions.append({\n                    \"column\": f\"{table}.{column}\",\n                    \"operator\": \"=\",\n                    \"value\": f\"'{value}'\",\n                    \"type\": \"filter\"\n                })\n                print(f\"  ‚ûï Ï°∞Í±¥ Ï∂îÍ∞Ä: {column} = {value}\")\n        \n        return new_conditions",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
        "startLine": 218
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "user_request",
    "symbolKind": "Kind(13)",
    "startLine": 132,
    "startChar": 33,
    "endLine": 132,
    "content": "def parse_user_request(self, user_request: str, current_conditions: List[Dict]) -> List[Dict[str, str]]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "current_conditions",
    "symbolKind": "Kind(13)",
    "startLine": 132,
    "startChar": 52,
    "endLine": 132,
    "content": "def parse_user_request(self, user_request: str, current_conditions: List[Dict]) -> List[Dict[str, str]]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "new_conditions",
    "symbolKind": "Kind(13)",
    "startLine": 140,
    "startChar": 8,
    "endLine": 140,
    "content": "new_conditions = current_conditions.copy()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "date_match",
    "symbolKind": "Kind(13)",
    "startLine": 143,
    "startChar": 8,
    "endLine": 143,
    "content": "date_match = re.search(r'ÎÇ†Ïßú.*?(\\d{8})', user_request)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "new_date",
    "symbolKind": "Kind(13)",
    "startLine": 145,
    "startChar": 12,
    "endLine": 145,
    "content": "new_date = date_match.group(1)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "cond",
    "symbolKind": "Kind(13)",
    "startLine": 146,
    "startChar": 16,
    "endLine": 146,
    "content": "for cond in new_conditions:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "route_match",
    "symbolKind": "Kind(13)",
    "startLine": 152,
    "startChar": 8,
    "endLine": 152,
    "content": "route_match = re.search(r'ÎÖ∏ÏÑ†.*?(\\d+)', user_request)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "new_route",
    "symbolKind": "Kind(13)",
    "startLine": 154,
    "startChar": 12,
    "endLine": 154,
    "content": "new_route = route_match.group(1)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "add_match",
    "symbolKind": "Kind(13)",
    "startLine": 161,
    "startChar": 8,
    "endLine": 161,
    "content": "add_match = re.search(r'(\\w+)(?:Ïù¥|Í∞Ä)\\s*[\\'\"]?(\\w+)[\\'\"]?', user_request)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "column",
    "symbolKind": "Kind(13)",
    "startLine": 163,
    "startChar": 12,
    "endLine": 163,
    "content": "column = add_match.group(1)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "value",
    "symbolKind": "Kind(13)",
    "startLine": 164,
    "startChar": 12,
    "endLine": 164,
    "content": "value = add_match.group(2)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "column_exists",
    "symbolKind": "Kind(13)",
    "startLine": 167,
    "startChar": 12,
    "endLine": 167,
    "content": "column_exists = any(column in cond['column'] for cond in new_conditions)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "table",
    "symbolKind": "Kind(13)",
    "startLine": 170,
    "startChar": 16,
    "endLine": 170,
    "content": "table = self._infer_table_name(column)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "_infer_table_name",
    "symbolKind": "Method",
    "startLine": 181,
    "startChar": 4,
    "endLine": 189,
    "content": "def _infer_table_name(self, column: str) -> str:\n        \"\"\"Ïª¨ÎüºÎ™ÖÏúºÎ°úÎ∂ÄÌÑ∞ ÌÖåÏù¥Î∏îÎ™Ö Ï∂îÎ°† (Í∞ÑÎã®Ìïú Îß§Ìïë)\"\"\"\n        column_table_map = {\n            \"base_date\": \"Trip_Log\",\n            \"route_nm\": \"Route_Master\",\n            \"station_nm\": \"Station_Master\",\n            \"trip_id\": \"Trip_Log\"\n        }\n        return column_table_map.get(column, \"Unknown\")",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
        "startLine": 170
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "column",
    "symbolKind": "Kind(13)",
    "startLine": 181,
    "startChar": 32,
    "endLine": 181,
    "content": "def _infer_table_name(self, column: str) -> str:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "column_table_map",
    "symbolKind": "Kind(13)",
    "startLine": 183,
    "startChar": 8,
    "endLine": 183,
    "content": "column_table_map = {",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "interactive_modify",
    "symbolKind": "Method",
    "startLine": 191,
    "startChar": 4,
    "endLine": 230,
    "content": "def interactive_modify(self, query_id: str, user_request: str) -> Optional[Dict[str, Any]]:\n        \"\"\"\n        ÎåÄÌôîÌòï ÏøºÎ¶¨ ÏàòÏ†ï\n        \n        Args:\n            query_id: ÏàòÏ†ïÌï† ÏøºÎ¶¨ ID\n            user_request: ÏÇ¨Ïö©Ïûê ÏöîÏ≤≠ (Ïòà: \"ÎÇ†ÏßúÎ•º 20251220ÏúºÎ°ú Î≥ÄÍ≤ΩÌï¥Ï§ò\")\n        \n        Returns:\n            ÏàòÏ†ïÎêú ÏøºÎ¶¨ Îç∞Ïù¥ÌÑ∞\n        \"\"\"\n        # 1. Í∏∞Ï°¥ ÏøºÎ¶¨ Î°úÎìú\n        query_data = self.load_query(query_id)\n        if not query_data:\n            return None\n        \n        print(f\"\\nüìã ÏõêÎ≥∏ ÏøºÎ¶¨: {query_data['question']}\")\n        print(f\"   SQL: {query_data['sql']['normalized'][:100]}...\")\n        \n        # 2. ÌòÑÏû¨ WHERE Ï°∞Í±¥ ÌôïÏù∏\n        current_conditions = query_data['sql']['structure']['where_conditions']\n        print(f\"\\nüîç ÌòÑÏû¨ Ï°∞Í±¥:\")\n        for cond in current_conditions:\n            print(f\"   - {cond['column']} {cond['operator']} {cond['value']}\")\n        \n        # 3. ÏÇ¨Ïö©Ïûê ÏöîÏ≤≠ ÌååÏã±\n        print(f\"\\nüí¨ ÏÇ¨Ïö©Ïûê ÏöîÏ≤≠: {user_request}\")\n        new_conditions = self.parse_user_request(user_request, current_conditions)\n        \n        # 4. ÏøºÎ¶¨ ÏàòÏ†ï\n        modified_data = self.modify_where_conditions(query_data, new_conditions)\n        \n        print(f\"\\n‚ú® ÏàòÏ†ïÎêú Ï°∞Í±¥:\")\n        for cond in new_conditions:\n            print(f\"   - {cond['column']} {cond['operator']} {cond['value']}\")\n        \n        print(f\"\\nüìù ÏàòÏ†ïÎêú SQL:\")\n        print(modified_data['sql']['normalized'])\n        \n        return modified_data",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
        "startLine": 270
      },
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
        "startLine": 284
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "query_id",
    "symbolKind": "Kind(13)",
    "startLine": 191,
    "startChar": 33,
    "endLine": 191,
    "content": "def interactive_modify(self, query_id: str, user_request: str) -> Optional[Dict[str, Any]]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "user_request",
    "symbolKind": "Kind(13)",
    "startLine": 191,
    "startChar": 48,
    "endLine": 191,
    "content": "def interactive_modify(self, query_id: str, user_request: str) -> Optional[Dict[str, Any]]:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "query_data",
    "symbolKind": "Kind(13)",
    "startLine": 203,
    "startChar": 8,
    "endLine": 203,
    "content": "query_data = self.load_query(query_id)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "current_conditions",
    "symbolKind": "Kind(13)",
    "startLine": 211,
    "startChar": 8,
    "endLine": 211,
    "content": "current_conditions = query_data['sql']['structure']['where_conditions']",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "cond",
    "symbolKind": "Kind(13)",
    "startLine": 213,
    "startChar": 12,
    "endLine": 213,
    "content": "for cond in current_conditions:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "new_conditions",
    "symbolKind": "Kind(13)",
    "startLine": 218,
    "startChar": 8,
    "endLine": 218,
    "content": "new_conditions = self.parse_user_request(user_request, current_conditions)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "modified_data",
    "symbolKind": "Kind(13)",
    "startLine": 221,
    "startChar": 8,
    "endLine": 221,
    "content": "modified_data = self.modify_where_conditions(query_data, new_conditions)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "data_dir",
    "symbolKind": "Kind(13)",
    "startLine": 25,
    "startChar": 17,
    "endLine": 25,
    "content": "self.data_dir = os.path.join(project_root, \"data\")",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "LLMQueryService",
    "symbolKind": "Class",
    "startLine": 233,
    "startChar": 0,
    "endLine": 258,
    "content": "class LLMQueryService:\n    \"\"\"\n    LLMÏùÑ ÏÇ¨Ïö©Ìïú ÏøºÎ¶¨ ÏàòÏ†ï ÏÑúÎπÑÏä§\n    (Ïã§Ï†ú LLM ÌÜµÌï©ÏùÄ Î≥ÑÎèÑÎ°ú Íµ¨ÌòÑ ÌïÑÏöî)\n    \"\"\"\n    \n    def __init__(self, data_dir: str = None):\n        self.modifier = QueryModifier(data_dir)\n    \n    def process_user_query(\n        self, \n        user_question: str,\n        context: Dict[str, Any] = None\n    ) -> Dict[str, Any]:\n        \"\"\"\n        ÏÇ¨Ïö©Ïûê ÏßàÎ¨∏ Ï≤òÎ¶¨\n        \n        1. Ïú†ÏÇ¨Ìïú ÏøºÎ¶¨ Í≤ÄÏÉâ (SQLiteÏóêÏÑú)\n        2. WHERE Ï°∞Í±¥ ÏàòÏ†ï\n        3. ÏàòÏ†ïÎêú ÏøºÎ¶¨ Ïã§Ìñâ (ÎòêÎäî Î∞òÌôò)\n        \"\"\"\n        # TODO: SQLiteÏóêÏÑú Ïú†ÏÇ¨Ìïú ÏøºÎ¶¨ Í≤ÄÏÉâ\n        # TODO: LLMÏùÑ ÏÇ¨Ïö©ÌïòÏó¨ Ï°∞Í±¥ Ï∂îÏ∂ú\n        # TODO: ÏøºÎ¶¨ ÏàòÏ†ï Î∞è Ïã§Ìñâ\n        \n        pass",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "__init__",
    "symbolKind": "Method",
    "startLine": 239,
    "startChar": 4,
    "endLine": 240,
    "content": "def __init__(self, data_dir: str = None):\n        self.modifier = QueryModifier(data_dir)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "data_dir",
    "symbolKind": "Kind(13)",
    "startLine": 239,
    "startChar": 23,
    "endLine": 239,
    "content": "def __init__(self, data_dir: str = None):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "process_user_query",
    "symbolKind": "Method",
    "startLine": 242,
    "startChar": 4,
    "endLine": 258,
    "content": "def process_user_query(\n        self, \n        user_question: str,\n        context: Dict[str, Any] = None\n    ) -> Dict[str, Any]:\n        \"\"\"\n        ÏÇ¨Ïö©Ïûê ÏßàÎ¨∏ Ï≤òÎ¶¨\n        \n        1. Ïú†ÏÇ¨Ìïú ÏøºÎ¶¨ Í≤ÄÏÉâ (SQLiteÏóêÏÑú)\n        2. WHERE Ï°∞Í±¥ ÏàòÏ†ï\n        3. ÏàòÏ†ïÎêú ÏøºÎ¶¨ Ïã§Ìñâ (ÎòêÎäî Î∞òÌôò)\n        \"\"\"\n        # TODO: SQLiteÏóêÏÑú Ïú†ÏÇ¨Ìïú ÏøºÎ¶¨ Í≤ÄÏÉâ\n        # TODO: LLMÏùÑ ÏÇ¨Ïö©ÌïòÏó¨ Ï°∞Í±¥ Ï∂îÏ∂ú\n        # TODO: ÏøºÎ¶¨ ÏàòÏ†ï Î∞è Ïã§Ìñâ\n        \n        pass",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "user_question",
    "symbolKind": "Kind(13)",
    "startLine": 244,
    "startChar": 8,
    "endLine": 244,
    "content": "user_question: str,",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "context",
    "symbolKind": "Kind(13)",
    "startLine": 245,
    "startChar": 8,
    "endLine": 245,
    "content": "context: Dict[str, Any] = None",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "modifier",
    "symbolKind": "Kind(13)",
    "startLine": 240,
    "startChar": 13,
    "endLine": 240,
    "content": "self.modifier = QueryModifier(data_dir)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "modifier",
    "symbolKind": "Kind(13)",
    "startLine": 263,
    "startChar": 4,
    "endLine": 263,
    "content": "modifier = QueryModifier()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "modified",
    "symbolKind": "Kind(13)",
    "startLine": 270,
    "startChar": 4,
    "endLine": 270,
    "content": "modified = modifier.interactive_modify(",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/query_modifier.py",
    "symbolName": "modified2",
    "symbolKind": "Kind(13)",
    "startLine": 284,
    "startChar": 4,
    "endLine": 284,
    "content": "modified2 = modifier.interactive_modify(",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "PyrightLSPClient",
    "symbolKind": "Class",
    "startLine": 7,
    "startChar": 0,
    "endLine": 242,
    "content": "class PyrightLSPClient:\n    \"\"\"\n    Pyright Language ServerÎ•º Ïù¥Ïö©Ìï¥ ÏΩîÎìúÏùò Ïã¨Î≥º(Node)Í≥º Ï∞∏Ï°∞ Í¥ÄÍ≥Ñ(Edge)Î•º Ï∂îÏ∂úÌïòÎäî ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏.\n    Îã®Ïàú ÌÖçÏä§Ìä∏ Î∂ÑÏÑùÏù¥ ÏïÑÎãå, Ïã§Ï†ú Ïª¥ÌååÏùºÎü¨ ÏàòÏ§ÄÏùò Ï†ïÏ†Å Î∂ÑÏÑù Í≤∞Í≥ºÎ•º ÌôúÏö©Ìï®.\n    \"\"\"\n    def __init__(self, workspace_path):\n        self.workspace_path = os.path.abspath(workspace_path)\n        self.project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))\n        self.data_dir = os.path.join(self.project_root, \"data\")\n\n        if not os.path.exists(self.data_dir):\n            os.makedirs(self.data_dir)\n\n        # Pyright Ïã§Ìñâ ÌååÏùº Í≤∞Ï†ï (OSÎ≥Ñ Í≤ΩÎ°ú Ï≤òÎ¶¨)\n        if os.name == 'nt':\n            cmd = 'pyright-langserver.cmd'\n        else:\n            # macOS/Linux: Ï†ÑÏ≤¥ Í≤ΩÎ°ú ÏÇ¨Ïö©\n            possible_paths = [\n                '/Users/bong/.npm-packages/bin/pyright-langserver',\n                '/Users/bong/Library/Python/3.9/bin/pyright-langserver',\n                'pyright-langserver'  # PATHÏóê ÏûàÎäî Í≤ΩÏö∞\n            ]\n            cmd = None\n            for path in possible_paths:\n                if os.path.exists(path) or path == 'pyright-langserver':\n                    cmd = path\n                    break\n            if cmd is None:\n                cmd = 'pyright-langserver'\n\n        # LSP ÏÑúÎ≤ÑÎ•º ÌëúÏ§Ä ÏûÖÏ∂úÎ†•(stdio) Î™®ÎìúÎ°ú Ïã§Ìñâ\n        # stderrÎäî Î∂àÌïÑÏöîÌïú Î°úÍ∑∏Í∞Ä ÏÑûÏù¥ÏßÄ ÏïäÎèÑÎ°ù Ï∞®Îã®\n\n        self.process = subprocess.Popen(\n            [cmd, '--stdio'],\n            stdin=subprocess.PIPE,\n            stdout=subprocess.PIPE,\n            stderr=subprocess.DEVNULL\n        )\n\n        self.request_id = 1 # Î™®Îì† ÏöîÏ≤≠Ïóê Í≥†Ïú† IDÎ•º Î∂ÄÏó¨Ìï¥ ÏùëÎãµÍ≥º Îß§Ïπ≠\n\n    def _send(self, method, params=None, is_notification=False):\n        \"\"\"\n        LSP ÏÑúÎ≤ÑÎ°ú JSON-RPC Î©îÏãúÏßÄ Ï†ÑÏÜ°.\n        is_notification=TrueÏù∏ Í≤ΩÏö∞ ÏÑúÎ≤ÑÏùò ÏùëÎãµÏùÑ Í∏∞Îã§Î¶¨ÏßÄ ÏïäÎäî ÏïåÎ¶º Ï†ÑÏÜ°.\n        \"\"\"\n\n        msg = {\"jsonrpc\": \"2.0\", \"method\": method, \"params\": params or {}}\n        if not is_notification:\n            msg[\"id\"] = self.request_id\n            self.request_id += 1\n\n        # LSP Í∑úÍ≤©: Content-Length Ìó§Îçî Îí§Ïóê JSON Î∞îÎîî Ï†ÑÏÜ°\n        body = json.dumps(msg)\n        full_msg = f\"Content-Length: {len(body)}\\r\\n\\r\\n{body}\"\n        self.process.stdin.write(full_msg.encode('utf-8'))\n        self.process.stdin.flush()\n        return msg.get(\"id\")\n\n\n    def _wait_for_response(self, target_id, timeout=10):\n        \"\"\"\n        ÌäπÏ†ï ÏöîÏ≤≠ IDÏóê ÎåÄÌïú ÏùëÎãµÏùÑ ÌÉÄÏûÑÏïÑÏõÉ Ï†ÑÍπåÏßÄ ÌååÏù¥ÌîÑÏóêÏÑú ÏùΩÏñ¥ Î∞òÌôò.\n        \"\"\"\n\n        start_time = time.time()\n        while time.time() - start_time < timeout:\n            line = self.process.stdout.readline().decode('utf-8', errors='ignore')\n            if \"Content-Length\" in line:\n                length_parts = line.split(\":\")\n                \n                if len(length_parts) < 2: continue\n\n                length = int(length_parts[1].strip())\n                self.process.stdout.readline() # Ìó§ÎçîÏôÄ Î∞îÎîî ÏÇ¨Ïù¥Ïùò Îπà Ï§Ñ(\\r\\n) Í±¥ÎÑàÎõ∞Í∏∞\n                body = self.process.stdout.read(length).decode('utf-8', errors='ignore')\n                resp = json.loads(body)\n              \n\n                # ÎÇ¥Í∞Ä Î≥¥ÎÇ∏ ÏöîÏ≤≠ IDÏôÄ ÏùºÏπòÌïòÎäî ÏùëÎãµÎßå ÌïÑÌÑ∞ÎßÅ\n                if resp.get(\"id\") == target_id:\n                    return resp.get(\"result\")\n        return None\n\n\n    def get_references(self, file_uri, line, character):\n        \"\"\"\n        [ÌïµÏã¨: Í∑∏ÎûòÌîÑ ÏÉùÏÑ± Î°úÏßÅ]\n        ÌäπÏ†ï ÏúÑÏπòÏùò Ïã¨Î≥ºÏù¥ ÌîÑÎ°úÏ†ùÌä∏ Ï†ÑÏ≤¥ Ï§ë Ïñ¥ÎîîÏóêÏÑú Ìò∏Ï∂ú(Ï∞∏Ï°∞)ÎêòÎäîÏßÄ ÏöîÏ≤≠.\n        \"\"\"\n\n        rid = self._send(\"textDocument/references\", {\n            \"textDocument\": {\"uri\": file_uri},\n            \"position\": {\"line\": line, \"character\": character},\n            \"context\": {\"includeDeclaration\": False} # Ìï®Ïàò Ï†ïÏùò(ÏÑ†Ïñ∏) ÏúÑÏπòÎäî Ï†úÏô∏ÌïòÍ≥† 'Ìò∏Ï∂úÏ≤ò'Îßå ÏàòÏßë\n        })\n\n        return self._wait_for_response(rid, timeout=5)\n\n\n    def flatten(self, symbols, path, file_uri):\n        \"\"\"\n        LSPÏùò Ìä∏Î¶¨ Íµ¨Ï°∞ Ïã¨Î≥º Îç∞Ïù¥ÌÑ∞Î•º DBÏóê Ï†ÄÏû•ÌïòÍ∏∞ Ï¢ãÍ≤å ÌèâÌÉÑÌôî(Flatten).\n        Í∞Å Ïã¨Î≥ºÏóê ÎåÄÌï¥ Ï†ÑÏó≠ Ï∞∏Ï°∞Î•º Ï∂îÏ†ÅÌïòÏó¨ Í¥ÄÍ≥Ñ Îç∞Ïù¥ÌÑ∞Î•º Ï∂îÍ∞ÄÌï®.\n        \"\"\"\n\n        res = []\n\n        # LSP Ïã¨Î≥º Kind Îß§Ìïë (5: Class, 6: Method, 12: Function Îì±)\n        kind_map = {1:\"File\", 2:\"Module\", 5:\"Class\", 6:\"Method\", 12:\"Function\", 23:\"Struct\"}\n\n        try:\n            with open(path, 'r', encoding='utf-8', errors='ignore') as f:\n                file_lines = f.readlines()\n\n        except Exception:\n            file_lines = []\n\n        def walk(s_list):\n            for s in s_list:\n                # range: Ïã¨Î≥º Ï†ÑÏ≤¥ ÏòÅÏó≠ (Ïòà: Ìï®Ïàò Îç∞ÏΩîÎ†àÏù¥ÌÑ∞Î∂ÄÌÑ∞ ÎÅùÍπåÏßÄ)\n                start_pos = s['range']['start']\n                end_pos = s['range']['end']\n               \n\n                # Ïã§Ï†ú ÌååÏùº ÎÇ¥ ÏÜåÏä§ ÏΩîÎìú Ï∂îÏ∂ú (0-based Ïù∏Îç±Ïä§ ÎåÄÏùë)\n                source_code = \"\".join(file_lines[start_pos['line'] : end_pos['line'] + 1]).strip()\n              \n\n                # [Optimization] Ìò∏Ï∂ú Í¥ÄÍ≥ÑÎäî Ï£ºÎ°ú Method(6)ÏôÄ Function(12)ÏóêÏÑúÎßå ÏùòÎØ∏Í∞Ä ÏûàÏùå\n                references = []\n                if s['kind'] in [6, 12]:\n                    # selectionRange: Ïã¨Î≥º 'Ïù¥Î¶Ñ'Ïù¥ Ï†ïÌôïÌûà ÏúÑÏπòÌïú Ï¢åÌëú (Ï∞∏Ï°∞ ÏöîÏ≤≠ Ïãú ÌïÑÏàò)\n                    ref_data = self.get_references(file_uri, s['selectionRange']['start']['line'], s['selectionRange']['start']['character'])\n                    if ref_data:\n                        # Ìò∏Ï∂úÏ≤òÏùò ÌååÏùº Í≤ΩÎ°úÏôÄ ÎùºÏù∏ Î≤àÌò∏Îßå Ï†ÄÏû•\n                        references = [{\n                            \"refPath\": r['uri'].replace(\"file:///\", \"\").replace(\"/\", os.sep),\n                            \"startLine\": r['range']['start']['line'] + 1\n                        } for r in ref_data]\n\n\n                res.append({\n                    \"filePath\": path,\n                    \"symbolName\": s['name'],\n                    \"symbolKind\": kind_map.get(s['kind'], f\"Kind({s['kind']})\"),\n                    \"startLine\": start_pos['line'] + 1, # ÏÇ¨ÎûåÏù¥ ÏùΩÍ∏∞ Ìé∏ÌïòÎèÑÎ°ù 1-based Î≥ÄÌôò\n                    \"startChar\": start_pos['character'],\n                    \"endLine\": end_pos['line'] + 1,\n                    \"content\": source_code,\n                    \"references\": references # Ïù¥ Ïã¨Î≥ºÏùÑ Î∂ÄÎ•¥Îäî 'Edge' Îç∞Ïù¥ÌÑ∞\n                })\n\n               \n\n                # Ïû¨Í∑ÄÏ†ÅÏúºÎ°ú ÏûêÏãù Ïã¨Î≥º ÌÉêÏÉâ (ÌÅ¥ÎûòÏä§ ÎÇ¥ Î©îÏÑúÎìú Îì±)\n                if 'children' in s:\n                    walk(s['children'])\n\n        walk(symbols)\n\n        return res\n\n\n\n    def run_indexer(self, target_workspace):\n        \"\"\"\n        Ï†ÑÏ≤¥ ÏõåÌÅ¨Ïä§ÌéòÏù¥Ïä§ Î∂ÑÏÑù Ïã§Ìñâ ÌîÑÎ°úÏÑ∏Ïä§.\n        \"\"\"\n\n        # 1. LSP Ìï∏ÎìúÏâêÏù¥ÌÅ¨ Î∞è Ïó≠Îüâ(Capabilities) ÏÑ†Ïñ∏\n        init_id = self._send(\"initialize\", {\n            \"rootUri\": f\"file://{target_workspace.replace(os.sep, '/')}\",\n            \"capabilities\": {\n                \"textDocument\": {\n                    \"documentSymbol\": {\"hierarchicalDocumentSymbolSupport\": True},\n                    \"references\": {\"dynamicRegistration\": True}\n                }\n            }\n        })\n\n        self._wait_for_response(init_id)\n        self._send(\"initialized\", is_notification=True)\n\n\n        print(f\"üöÄ Í∑∏ÎûòÌîÑ Ïù∏Îç±Ïã± ÏãúÏûë (LSP ver1.2): {target_workspace}\")\n        all_results = []\n\n        # ÏõåÌÅ¨Ïä§ÌéòÏù¥Ïä§ ÎÇ¥ Î™®Îì† .py ÌååÏùº ÏàòÏßë\n        py_files = []\n\n        for root, _, files in os.walk(target_workspace):\n            if any(ex in root for ex in [\".git\", \".venv\", \"node_modules\", \"__pycache__\"]): continue\n            for file in files:\n                if file.endswith(\".py\"):\n                    py_files.append(os.path.join(root, file))\n\n\n        # [Îã®Í≥Ñ 1] Ï†ÑÏó≠ Ïã¨Î≥º ÌÖåÏù¥Î∏î Íµ¨Ï∂ï (Pre-analysis)\n        # Î™®Îì† ÌååÏùºÏùÑ didOpenÏúºÎ°ú ÏÑúÎ≤ÑÏóê ÏïåÎ†§Ï§òÏïº ÌååÏùº Í∞Ñ ÏùòÏ°¥ÏÑ± Ï∂îÏ†ÅÏù¥ Í∞ÄÎä•Ìï®\n\n        for path in py_files:\n            file_uri = f\"file://{path.replace(os.sep, '/')}\"\n            with open(path, 'r', encoding='utf-8', errors='ignore') as f:\n                self._send(\"textDocument/didOpen\", {\n                    \"textDocument\": {\"uri\": file_uri, \"languageId\": \"python\", \"version\": 1, \"text\": f.read()}\n                }, is_notification=True)\n\n        # PyrightÍ∞Ä Î∞±Í∑∏ÎùºÏö¥ÎìúÏóêÏÑú ÌîÑÎ°úÏ†ùÌä∏ Ï†ÑÏ≤¥Î•º Ïù∏Îç±Ïã±Ìï† ÏãúÍ∞ÑÏùÑ Î∂ÄÏó¨\n        time.sleep(2)\n\n        # [Îã®Í≥Ñ 2] ÏÉÅÏÑ∏ Ïã¨Î≥º Î∞è Ìò∏Ï∂ú Í¥ÄÍ≥Ñ Ï∂îÏ∂ú\n        for path in py_files:\n            print(f\"  üîç Î∂ÑÏÑù Ï§ë: {os.path.basename(path)}\")\n            file_uri = f\"file://{path.replace(os.sep, '/')}\"\n\n            # Ìï¥Îãπ ÌååÏùº ÎÇ¥Ïùò Íµ¨Ï°∞(Ïã¨Î≥º) ÏöîÏ≤≠\n            sid = self._send(\"textDocument/documentSymbol\", {\"textDocument\": {\"uri\": file_uri}})\n            symbols = self._wait_for_response(sid)\n\n\n            if symbols:\n                all_results.extend(self.flatten(symbols, path, file_uri))\n\n\n        # 3. Î∂ÑÏÑù Í≤∞Í≥º JSON Ï†ÄÏû•\n        output_path = os.path.join(self.data_dir, \"symbols_output_lsp.json\")\n\n        with open(output_path, \"w\", encoding='utf-8') as f:\n            json.dump(all_results, f, indent=2, ensure_ascii=False)\n\n\n        print(f\"\\n‚ú® Ïù∏Îç±Ïã± ÏôÑÎ£å! Ï¥ù {len(all_results)}Í∞ú Ïã¨Î≥º Ï∂îÏ∂úÎê®.\")\n        self.process.terminate() # ÌîÑÎ°úÏÑ∏Ïä§ Ï†ïÏÉÅ Ï¢ÖÎ£å",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "__init__",
    "symbolKind": "Method",
    "startLine": 12,
    "startChar": 4,
    "endLine": 48,
    "content": "def __init__(self, workspace_path):\n        self.workspace_path = os.path.abspath(workspace_path)\n        self.project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))\n        self.data_dir = os.path.join(self.project_root, \"data\")\n\n        if not os.path.exists(self.data_dir):\n            os.makedirs(self.data_dir)\n\n        # Pyright Ïã§Ìñâ ÌååÏùº Í≤∞Ï†ï (OSÎ≥Ñ Í≤ΩÎ°ú Ï≤òÎ¶¨)\n        if os.name == 'nt':\n            cmd = 'pyright-langserver.cmd'\n        else:\n            # macOS/Linux: Ï†ÑÏ≤¥ Í≤ΩÎ°ú ÏÇ¨Ïö©\n            possible_paths = [\n                '/Users/bong/.npm-packages/bin/pyright-langserver',\n                '/Users/bong/Library/Python/3.9/bin/pyright-langserver',\n                'pyright-langserver'  # PATHÏóê ÏûàÎäî Í≤ΩÏö∞\n            ]\n            cmd = None\n            for path in possible_paths:\n                if os.path.exists(path) or path == 'pyright-langserver':\n                    cmd = path\n                    break\n            if cmd is None:\n                cmd = 'pyright-langserver'\n\n        # LSP ÏÑúÎ≤ÑÎ•º ÌëúÏ§Ä ÏûÖÏ∂úÎ†•(stdio) Î™®ÎìúÎ°ú Ïã§Ìñâ\n        # stderrÎäî Î∂àÌïÑÏöîÌïú Î°úÍ∑∏Í∞Ä ÏÑûÏù¥ÏßÄ ÏïäÎèÑÎ°ù Ï∞®Îã®\n\n        self.process = subprocess.Popen(\n            [cmd, '--stdio'],\n            stdin=subprocess.PIPE,\n            stdout=subprocess.PIPE,\n            stderr=subprocess.DEVNULL\n        )\n\n        self.request_id = 1 # Î™®Îì† ÏöîÏ≤≠Ïóê Í≥†Ïú† IDÎ•º Î∂ÄÏó¨Ìï¥ ÏùëÎãµÍ≥º Îß§Ïπ≠",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "workspace_path",
    "symbolKind": "Kind(13)",
    "startLine": 12,
    "startChar": 23,
    "endLine": 12,
    "content": "def __init__(self, workspace_path):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "possible_paths",
    "symbolKind": "Kind(13)",
    "startLine": 25,
    "startChar": 12,
    "endLine": 25,
    "content": "possible_paths = [",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "cmd",
    "symbolKind": "Kind(13)",
    "startLine": 30,
    "startChar": 12,
    "endLine": 30,
    "content": "cmd = None",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "path",
    "symbolKind": "Kind(13)",
    "startLine": 31,
    "startChar": 16,
    "endLine": 31,
    "content": "for path in possible_paths:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "_send",
    "symbolKind": "Method",
    "startLine": 50,
    "startChar": 4,
    "endLine": 66,
    "content": "def _send(self, method, params=None, is_notification=False):\n        \"\"\"\n        LSP ÏÑúÎ≤ÑÎ°ú JSON-RPC Î©îÏãúÏßÄ Ï†ÑÏÜ°.\n        is_notification=TrueÏù∏ Í≤ΩÏö∞ ÏÑúÎ≤ÑÏùò ÏùëÎãµÏùÑ Í∏∞Îã§Î¶¨ÏßÄ ÏïäÎäî ÏïåÎ¶º Ï†ÑÏÜ°.\n        \"\"\"\n\n        msg = {\"jsonrpc\": \"2.0\", \"method\": method, \"params\": params or {}}\n        if not is_notification:\n            msg[\"id\"] = self.request_id\n            self.request_id += 1\n\n        # LSP Í∑úÍ≤©: Content-Length Ìó§Îçî Îí§Ïóê JSON Î∞îÎîî Ï†ÑÏÜ°\n        body = json.dumps(msg)\n        full_msg = f\"Content-Length: {len(body)}\\r\\n\\r\\n{body}\"\n        self.process.stdin.write(full_msg.encode('utf-8'))\n        self.process.stdin.flush()\n        return msg.get(\"id\")",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
        "startLine": 100
      },
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
        "startLine": 180
      },
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
        "startLine": 191
      },
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
        "startLine": 213
      },
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
        "startLine": 226
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "method",
    "symbolKind": "Kind(13)",
    "startLine": 50,
    "startChar": 20,
    "endLine": 50,
    "content": "def _send(self, method, params=None, is_notification=False):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "params",
    "symbolKind": "Kind(13)",
    "startLine": 50,
    "startChar": 28,
    "endLine": 50,
    "content": "def _send(self, method, params=None, is_notification=False):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "is_notification",
    "symbolKind": "Kind(13)",
    "startLine": 50,
    "startChar": 41,
    "endLine": 50,
    "content": "def _send(self, method, params=None, is_notification=False):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "msg",
    "symbolKind": "Kind(13)",
    "startLine": 56,
    "startChar": 8,
    "endLine": 56,
    "content": "msg = {\"jsonrpc\": \"2.0\", \"method\": method, \"params\": params or {}}",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "body",
    "symbolKind": "Kind(13)",
    "startLine": 62,
    "startChar": 8,
    "endLine": 62,
    "content": "body = json.dumps(msg)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "full_msg",
    "symbolKind": "Kind(13)",
    "startLine": 63,
    "startChar": 8,
    "endLine": 63,
    "content": "full_msg = f\"Content-Length: {len(body)}\\r\\n\\r\\n{body}\"",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "_wait_for_response",
    "symbolKind": "Method",
    "startLine": 69,
    "startChar": 4,
    "endLine": 91,
    "content": "def _wait_for_response(self, target_id, timeout=10):\n        \"\"\"\n        ÌäπÏ†ï ÏöîÏ≤≠ IDÏóê ÎåÄÌïú ÏùëÎãµÏùÑ ÌÉÄÏûÑÏïÑÏõÉ Ï†ÑÍπåÏßÄ ÌååÏù¥ÌîÑÏóêÏÑú ÏùΩÏñ¥ Î∞òÌôò.\n        \"\"\"\n\n        start_time = time.time()\n        while time.time() - start_time < timeout:\n            line = self.process.stdout.readline().decode('utf-8', errors='ignore')\n            if \"Content-Length\" in line:\n                length_parts = line.split(\":\")\n                \n                if len(length_parts) < 2: continue\n\n                length = int(length_parts[1].strip())\n                self.process.stdout.readline() # Ìó§ÎçîÏôÄ Î∞îÎîî ÏÇ¨Ïù¥Ïùò Îπà Ï§Ñ(\\r\\n) Í±¥ÎÑàÎõ∞Í∏∞\n                body = self.process.stdout.read(length).decode('utf-8', errors='ignore')\n                resp = json.loads(body)\n              \n\n                # ÎÇ¥Í∞Ä Î≥¥ÎÇ∏ ÏöîÏ≤≠ IDÏôÄ ÏùºÏπòÌïòÎäî ÏùëÎãµÎßå ÌïÑÌÑ∞ÎßÅ\n                if resp.get(\"id\") == target_id:\n                    return resp.get(\"result\")\n        return None",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
        "startLine": 106
      },
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
        "startLine": 190
      },
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
        "startLine": 227
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "target_id",
    "symbolKind": "Kind(13)",
    "startLine": 69,
    "startChar": 33,
    "endLine": 69,
    "content": "def _wait_for_response(self, target_id, timeout=10):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "timeout",
    "symbolKind": "Kind(13)",
    "startLine": 69,
    "startChar": 44,
    "endLine": 69,
    "content": "def _wait_for_response(self, target_id, timeout=10):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "start_time",
    "symbolKind": "Kind(13)",
    "startLine": 74,
    "startChar": 8,
    "endLine": 74,
    "content": "start_time = time.time()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "line",
    "symbolKind": "Kind(13)",
    "startLine": 76,
    "startChar": 12,
    "endLine": 76,
    "content": "line = self.process.stdout.readline().decode('utf-8', errors='ignore')",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "length_parts",
    "symbolKind": "Kind(13)",
    "startLine": 78,
    "startChar": 16,
    "endLine": 78,
    "content": "length_parts = line.split(\":\")",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "length",
    "symbolKind": "Kind(13)",
    "startLine": 82,
    "startChar": 16,
    "endLine": 82,
    "content": "length = int(length_parts[1].strip())",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "body",
    "symbolKind": "Kind(13)",
    "startLine": 84,
    "startChar": 16,
    "endLine": 84,
    "content": "body = self.process.stdout.read(length).decode('utf-8', errors='ignore')",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "resp",
    "symbolKind": "Kind(13)",
    "startLine": 85,
    "startChar": 16,
    "endLine": 85,
    "content": "resp = json.loads(body)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "get_references",
    "symbolKind": "Method",
    "startLine": 94,
    "startChar": 4,
    "endLine": 106,
    "content": "def get_references(self, file_uri, line, character):\n        \"\"\"\n        [ÌïµÏã¨: Í∑∏ÎûòÌîÑ ÏÉùÏÑ± Î°úÏßÅ]\n        ÌäπÏ†ï ÏúÑÏπòÏùò Ïã¨Î≥ºÏù¥ ÌîÑÎ°úÏ†ùÌä∏ Ï†ÑÏ≤¥ Ï§ë Ïñ¥ÎîîÏóêÏÑú Ìò∏Ï∂ú(Ï∞∏Ï°∞)ÎêòÎäîÏßÄ ÏöîÏ≤≠.\n        \"\"\"\n\n        rid = self._send(\"textDocument/references\", {\n            \"textDocument\": {\"uri\": file_uri},\n            \"position\": {\"line\": line, \"character\": character},\n            \"context\": {\"includeDeclaration\": False} # Ìï®Ïàò Ï†ïÏùò(ÏÑ†Ïñ∏) ÏúÑÏπòÎäî Ï†úÏô∏ÌïòÍ≥† 'Ìò∏Ï∂úÏ≤ò'Îßå ÏàòÏßë\n        })\n\n        return self._wait_for_response(rid, timeout=5)",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
        "startLine": 142
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "file_uri",
    "symbolKind": "Kind(13)",
    "startLine": 94,
    "startChar": 29,
    "endLine": 94,
    "content": "def get_references(self, file_uri, line, character):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "line",
    "symbolKind": "Kind(13)",
    "startLine": 94,
    "startChar": 39,
    "endLine": 94,
    "content": "def get_references(self, file_uri, line, character):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "character",
    "symbolKind": "Kind(13)",
    "startLine": 94,
    "startChar": 45,
    "endLine": 94,
    "content": "def get_references(self, file_uri, line, character):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "rid",
    "symbolKind": "Kind(13)",
    "startLine": 100,
    "startChar": 8,
    "endLine": 100,
    "content": "rid = self._send(\"textDocument/references\", {",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "flatten",
    "symbolKind": "Method",
    "startLine": 109,
    "startChar": 4,
    "endLine": 170,
    "content": "def flatten(self, symbols, path, file_uri):\n        \"\"\"\n        LSPÏùò Ìä∏Î¶¨ Íµ¨Ï°∞ Ïã¨Î≥º Îç∞Ïù¥ÌÑ∞Î•º DBÏóê Ï†ÄÏû•ÌïòÍ∏∞ Ï¢ãÍ≤å ÌèâÌÉÑÌôî(Flatten).\n        Í∞Å Ïã¨Î≥ºÏóê ÎåÄÌï¥ Ï†ÑÏó≠ Ï∞∏Ï°∞Î•º Ï∂îÏ†ÅÌïòÏó¨ Í¥ÄÍ≥Ñ Îç∞Ïù¥ÌÑ∞Î•º Ï∂îÍ∞ÄÌï®.\n        \"\"\"\n\n        res = []\n\n        # LSP Ïã¨Î≥º Kind Îß§Ìïë (5: Class, 6: Method, 12: Function Îì±)\n        kind_map = {1:\"File\", 2:\"Module\", 5:\"Class\", 6:\"Method\", 12:\"Function\", 23:\"Struct\"}\n\n        try:\n            with open(path, 'r', encoding='utf-8', errors='ignore') as f:\n                file_lines = f.readlines()\n\n        except Exception:\n            file_lines = []\n\n        def walk(s_list):\n            for s in s_list:\n                # range: Ïã¨Î≥º Ï†ÑÏ≤¥ ÏòÅÏó≠ (Ïòà: Ìï®Ïàò Îç∞ÏΩîÎ†àÏù¥ÌÑ∞Î∂ÄÌÑ∞ ÎÅùÍπåÏßÄ)\n                start_pos = s['range']['start']\n                end_pos = s['range']['end']\n               \n\n                # Ïã§Ï†ú ÌååÏùº ÎÇ¥ ÏÜåÏä§ ÏΩîÎìú Ï∂îÏ∂ú (0-based Ïù∏Îç±Ïä§ ÎåÄÏùë)\n                source_code = \"\".join(file_lines[start_pos['line'] : end_pos['line'] + 1]).strip()\n              \n\n                # [Optimization] Ìò∏Ï∂ú Í¥ÄÍ≥ÑÎäî Ï£ºÎ°ú Method(6)ÏôÄ Function(12)ÏóêÏÑúÎßå ÏùòÎØ∏Í∞Ä ÏûàÏùå\n                references = []\n                if s['kind'] in [6, 12]:\n                    # selectionRange: Ïã¨Î≥º 'Ïù¥Î¶Ñ'Ïù¥ Ï†ïÌôïÌûà ÏúÑÏπòÌïú Ï¢åÌëú (Ï∞∏Ï°∞ ÏöîÏ≤≠ Ïãú ÌïÑÏàò)\n                    ref_data = self.get_references(file_uri, s['selectionRange']['start']['line'], s['selectionRange']['start']['character'])\n                    if ref_data:\n                        # Ìò∏Ï∂úÏ≤òÏùò ÌååÏùº Í≤ΩÎ°úÏôÄ ÎùºÏù∏ Î≤àÌò∏Îßå Ï†ÄÏû•\n                        references = [{\n                            \"refPath\": r['uri'].replace(\"file:///\", \"\").replace(\"/\", os.sep),\n                            \"startLine\": r['range']['start']['line'] + 1\n                        } for r in ref_data]\n\n\n                res.append({\n                    \"filePath\": path,\n                    \"symbolName\": s['name'],\n                    \"symbolKind\": kind_map.get(s['kind'], f\"Kind({s['kind']})\"),\n                    \"startLine\": start_pos['line'] + 1, # ÏÇ¨ÎûåÏù¥ ÏùΩÍ∏∞ Ìé∏ÌïòÎèÑÎ°ù 1-based Î≥ÄÌôò\n                    \"startChar\": start_pos['character'],\n                    \"endLine\": end_pos['line'] + 1,\n                    \"content\": source_code,\n                    \"references\": references # Ïù¥ Ïã¨Î≥ºÏùÑ Î∂ÄÎ•¥Îäî 'Edge' Îç∞Ïù¥ÌÑ∞\n                })\n\n               \n\n                # Ïû¨Í∑ÄÏ†ÅÏúºÎ°ú ÏûêÏãù Ïã¨Î≥º ÌÉêÏÉâ (ÌÅ¥ÎûòÏä§ ÎÇ¥ Î©îÏÑúÎìú Îì±)\n                if 'children' in s:\n                    walk(s['children'])\n\n        walk(symbols)\n\n        return res",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
        "startLine": 231
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "symbols",
    "symbolKind": "Kind(13)",
    "startLine": 109,
    "startChar": 22,
    "endLine": 109,
    "content": "def flatten(self, symbols, path, file_uri):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "path",
    "symbolKind": "Kind(13)",
    "startLine": 109,
    "startChar": 31,
    "endLine": 109,
    "content": "def flatten(self, symbols, path, file_uri):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "file_uri",
    "symbolKind": "Kind(13)",
    "startLine": 109,
    "startChar": 37,
    "endLine": 109,
    "content": "def flatten(self, symbols, path, file_uri):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "res",
    "symbolKind": "Kind(13)",
    "startLine": 115,
    "startChar": 8,
    "endLine": 115,
    "content": "res = []",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "kind_map",
    "symbolKind": "Kind(13)",
    "startLine": 118,
    "startChar": 8,
    "endLine": 118,
    "content": "kind_map = {1:\"File\", 2:\"Module\", 5:\"Class\", 6:\"Method\", 12:\"Function\", 23:\"Struct\"}",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "f",
    "symbolKind": "Kind(13)",
    "startLine": 121,
    "startChar": 71,
    "endLine": 121,
    "content": "with open(path, 'r', encoding='utf-8', errors='ignore') as f:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "file_lines",
    "symbolKind": "Kind(13)",
    "startLine": 122,
    "startChar": 16,
    "endLine": 122,
    "content": "file_lines = f.readlines()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "walk",
    "symbolKind": "Function",
    "startLine": 127,
    "startChar": 8,
    "endLine": 166,
    "content": "def walk(s_list):\n            for s in s_list:\n                # range: Ïã¨Î≥º Ï†ÑÏ≤¥ ÏòÅÏó≠ (Ïòà: Ìï®Ïàò Îç∞ÏΩîÎ†àÏù¥ÌÑ∞Î∂ÄÌÑ∞ ÎÅùÍπåÏßÄ)\n                start_pos = s['range']['start']\n                end_pos = s['range']['end']\n               \n\n                # Ïã§Ï†ú ÌååÏùº ÎÇ¥ ÏÜåÏä§ ÏΩîÎìú Ï∂îÏ∂ú (0-based Ïù∏Îç±Ïä§ ÎåÄÏùë)\n                source_code = \"\".join(file_lines[start_pos['line'] : end_pos['line'] + 1]).strip()\n              \n\n                # [Optimization] Ìò∏Ï∂ú Í¥ÄÍ≥ÑÎäî Ï£ºÎ°ú Method(6)ÏôÄ Function(12)ÏóêÏÑúÎßå ÏùòÎØ∏Í∞Ä ÏûàÏùå\n                references = []\n                if s['kind'] in [6, 12]:\n                    # selectionRange: Ïã¨Î≥º 'Ïù¥Î¶Ñ'Ïù¥ Ï†ïÌôïÌûà ÏúÑÏπòÌïú Ï¢åÌëú (Ï∞∏Ï°∞ ÏöîÏ≤≠ Ïãú ÌïÑÏàò)\n                    ref_data = self.get_references(file_uri, s['selectionRange']['start']['line'], s['selectionRange']['start']['character'])\n                    if ref_data:\n                        # Ìò∏Ï∂úÏ≤òÏùò ÌååÏùº Í≤ΩÎ°úÏôÄ ÎùºÏù∏ Î≤àÌò∏Îßå Ï†ÄÏû•\n                        references = [{\n                            \"refPath\": r['uri'].replace(\"file:///\", \"\").replace(\"/\", os.sep),\n                            \"startLine\": r['range']['start']['line'] + 1\n                        } for r in ref_data]\n\n\n                res.append({\n                    \"filePath\": path,\n                    \"symbolName\": s['name'],\n                    \"symbolKind\": kind_map.get(s['kind'], f\"Kind({s['kind']})\"),\n                    \"startLine\": start_pos['line'] + 1, # ÏÇ¨ÎûåÏù¥ ÏùΩÍ∏∞ Ìé∏ÌïòÎèÑÎ°ù 1-based Î≥ÄÌôò\n                    \"startChar\": start_pos['character'],\n                    \"endLine\": end_pos['line'] + 1,\n                    \"content\": source_code,\n                    \"references\": references # Ïù¥ Ïã¨Î≥ºÏùÑ Î∂ÄÎ•¥Îäî 'Edge' Îç∞Ïù¥ÌÑ∞\n                })\n\n               \n\n                # Ïû¨Í∑ÄÏ†ÅÏúºÎ°ú ÏûêÏãù Ïã¨Î≥º ÌÉêÏÉâ (ÌÅ¥ÎûòÏä§ ÎÇ¥ Î©îÏÑúÎìú Îì±)\n                if 'children' in s:\n                    walk(s['children'])",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
        "startLine": 166
      },
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
        "startLine": 168
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "s_list",
    "symbolKind": "Kind(13)",
    "startLine": 127,
    "startChar": 17,
    "endLine": 127,
    "content": "def walk(s_list):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "s",
    "symbolKind": "Kind(13)",
    "startLine": 128,
    "startChar": 16,
    "endLine": 128,
    "content": "for s in s_list:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "start_pos",
    "symbolKind": "Kind(13)",
    "startLine": 130,
    "startChar": 16,
    "endLine": 130,
    "content": "start_pos = s['range']['start']",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "end_pos",
    "symbolKind": "Kind(13)",
    "startLine": 131,
    "startChar": 16,
    "endLine": 131,
    "content": "end_pos = s['range']['end']",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "source_code",
    "symbolKind": "Kind(13)",
    "startLine": 135,
    "startChar": 16,
    "endLine": 135,
    "content": "source_code = \"\".join(file_lines[start_pos['line'] : end_pos['line'] + 1]).strip()",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "references",
    "symbolKind": "Kind(13)",
    "startLine": 139,
    "startChar": 16,
    "endLine": 139,
    "content": "references = []",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "ref_data",
    "symbolKind": "Kind(13)",
    "startLine": 142,
    "startChar": 20,
    "endLine": 142,
    "content": "ref_data = self.get_references(file_uri, s['selectionRange']['start']['line'], s['selectionRange']['start']['character'])",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "run_indexer",
    "symbolKind": "Method",
    "startLine": 174,
    "startChar": 4,
    "endLine": 242,
    "content": "def run_indexer(self, target_workspace):\n        \"\"\"\n        Ï†ÑÏ≤¥ ÏõåÌÅ¨Ïä§ÌéòÏù¥Ïä§ Î∂ÑÏÑù Ïã§Ìñâ ÌîÑÎ°úÏÑ∏Ïä§.\n        \"\"\"\n\n        # 1. LSP Ìï∏ÎìúÏâêÏù¥ÌÅ¨ Î∞è Ïó≠Îüâ(Capabilities) ÏÑ†Ïñ∏\n        init_id = self._send(\"initialize\", {\n            \"rootUri\": f\"file://{target_workspace.replace(os.sep, '/')}\",\n            \"capabilities\": {\n                \"textDocument\": {\n                    \"documentSymbol\": {\"hierarchicalDocumentSymbolSupport\": True},\n                    \"references\": {\"dynamicRegistration\": True}\n                }\n            }\n        })\n\n        self._wait_for_response(init_id)\n        self._send(\"initialized\", is_notification=True)\n\n\n        print(f\"üöÄ Í∑∏ÎûòÌîÑ Ïù∏Îç±Ïã± ÏãúÏûë (LSP ver1.2): {target_workspace}\")\n        all_results = []\n\n        # ÏõåÌÅ¨Ïä§ÌéòÏù¥Ïä§ ÎÇ¥ Î™®Îì† .py ÌååÏùº ÏàòÏßë\n        py_files = []\n\n        for root, _, files in os.walk(target_workspace):\n            if any(ex in root for ex in [\".git\", \".venv\", \"node_modules\", \"__pycache__\"]): continue\n            for file in files:\n                if file.endswith(\".py\"):\n                    py_files.append(os.path.join(root, file))\n\n\n        # [Îã®Í≥Ñ 1] Ï†ÑÏó≠ Ïã¨Î≥º ÌÖåÏù¥Î∏î Íµ¨Ï∂ï (Pre-analysis)\n        # Î™®Îì† ÌååÏùºÏùÑ didOpenÏúºÎ°ú ÏÑúÎ≤ÑÏóê ÏïåÎ†§Ï§òÏïº ÌååÏùº Í∞Ñ ÏùòÏ°¥ÏÑ± Ï∂îÏ†ÅÏù¥ Í∞ÄÎä•Ìï®\n\n        for path in py_files:\n            file_uri = f\"file://{path.replace(os.sep, '/')}\"\n            with open(path, 'r', encoding='utf-8', errors='ignore') as f:\n                self._send(\"textDocument/didOpen\", {\n                    \"textDocument\": {\"uri\": file_uri, \"languageId\": \"python\", \"version\": 1, \"text\": f.read()}\n                }, is_notification=True)\n\n        # PyrightÍ∞Ä Î∞±Í∑∏ÎùºÏö¥ÎìúÏóêÏÑú ÌîÑÎ°úÏ†ùÌä∏ Ï†ÑÏ≤¥Î•º Ïù∏Îç±Ïã±Ìï† ÏãúÍ∞ÑÏùÑ Î∂ÄÏó¨\n        time.sleep(2)\n\n        # [Îã®Í≥Ñ 2] ÏÉÅÏÑ∏ Ïã¨Î≥º Î∞è Ìò∏Ï∂ú Í¥ÄÍ≥Ñ Ï∂îÏ∂ú\n        for path in py_files:\n            print(f\"  üîç Î∂ÑÏÑù Ï§ë: {os.path.basename(path)}\")\n            file_uri = f\"file://{path.replace(os.sep, '/')}\"\n\n            # Ìï¥Îãπ ÌååÏùº ÎÇ¥Ïùò Íµ¨Ï°∞(Ïã¨Î≥º) ÏöîÏ≤≠\n            sid = self._send(\"textDocument/documentSymbol\", {\"textDocument\": {\"uri\": file_uri}})\n            symbols = self._wait_for_response(sid)\n\n\n            if symbols:\n                all_results.extend(self.flatten(symbols, path, file_uri))\n\n\n        # 3. Î∂ÑÏÑù Í≤∞Í≥º JSON Ï†ÄÏû•\n        output_path = os.path.join(self.data_dir, \"symbols_output_lsp.json\")\n\n        with open(output_path, \"w\", encoding='utf-8') as f:\n            json.dump(all_results, f, indent=2, ensure_ascii=False)\n\n\n        print(f\"\\n‚ú® Ïù∏Îç±Ïã± ÏôÑÎ£å! Ï¥ù {len(all_results)}Í∞ú Ïã¨Î≥º Ï∂îÏ∂úÎê®.\")\n        self.process.terminate() # ÌîÑÎ°úÏÑ∏Ïä§ Ï†ïÏÉÅ Ï¢ÖÎ£å",
    "references": [
      {
        "refPath": "Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
        "startLine": 257
      }
    ]
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "target_workspace",
    "symbolKind": "Kind(13)",
    "startLine": 174,
    "startChar": 26,
    "endLine": 174,
    "content": "def run_indexer(self, target_workspace):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "init_id",
    "symbolKind": "Kind(13)",
    "startLine": 180,
    "startChar": 8,
    "endLine": 180,
    "content": "init_id = self._send(\"initialize\", {",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "all_results",
    "symbolKind": "Kind(13)",
    "startLine": 195,
    "startChar": 8,
    "endLine": 195,
    "content": "all_results = []",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "py_files",
    "symbolKind": "Kind(13)",
    "startLine": 198,
    "startChar": 8,
    "endLine": 198,
    "content": "py_files = []",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "root",
    "symbolKind": "Kind(13)",
    "startLine": 200,
    "startChar": 12,
    "endLine": 200,
    "content": "for root, _, files in os.walk(target_workspace):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "files",
    "symbolKind": "Kind(13)",
    "startLine": 200,
    "startChar": 21,
    "endLine": 200,
    "content": "for root, _, files in os.walk(target_workspace):",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "file",
    "symbolKind": "Kind(13)",
    "startLine": 202,
    "startChar": 16,
    "endLine": 202,
    "content": "for file in files:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "path",
    "symbolKind": "Kind(13)",
    "startLine": 210,
    "startChar": 12,
    "endLine": 210,
    "content": "for path in py_files:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "file_uri",
    "symbolKind": "Kind(13)",
    "startLine": 211,
    "startChar": 12,
    "endLine": 211,
    "content": "file_uri = f\"file://{path.replace(os.sep, '/')}\"",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "f",
    "symbolKind": "Kind(13)",
    "startLine": 212,
    "startChar": 71,
    "endLine": 212,
    "content": "with open(path, 'r', encoding='utf-8', errors='ignore') as f:",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "sid",
    "symbolKind": "Kind(13)",
    "startLine": 226,
    "startChar": 12,
    "endLine": 226,
    "content": "sid = self._send(\"textDocument/documentSymbol\", {\"textDocument\": {\"uri\": file_uri}})",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "symbols",
    "symbolKind": "Kind(13)",
    "startLine": 227,
    "startChar": 12,
    "endLine": 227,
    "content": "symbols = self._wait_for_response(sid)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "output_path",
    "symbolKind": "Kind(13)",
    "startLine": 235,
    "startChar": 8,
    "endLine": 235,
    "content": "output_path = os.path.join(self.data_dir, \"symbols_output_lsp.json\")",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "workspace_path",
    "symbolKind": "Kind(13)",
    "startLine": 13,
    "startChar": 13,
    "endLine": 13,
    "content": "self.workspace_path = os.path.abspath(workspace_path)",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "project_root",
    "symbolKind": "Kind(13)",
    "startLine": 14,
    "startChar": 13,
    "endLine": 14,
    "content": "self.project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "data_dir",
    "symbolKind": "Kind(13)",
    "startLine": 15,
    "startChar": 13,
    "endLine": 15,
    "content": "self.data_dir = os.path.join(self.project_root, \"data\")",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "process",
    "symbolKind": "Kind(13)",
    "startLine": 41,
    "startChar": 13,
    "endLine": 41,
    "content": "self.process = subprocess.Popen(",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "request_id",
    "symbolKind": "Kind(13)",
    "startLine": 48,
    "startChar": 13,
    "endLine": 48,
    "content": "self.request_id = 1 # Î™®Îì† ÏöîÏ≤≠Ïóê Í≥†Ïú† IDÎ•º Î∂ÄÏó¨Ìï¥ ÏùëÎãµÍ≥º Îß§Ïπ≠",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "target_dir",
    "symbolKind": "Kind(13)",
    "startLine": 250,
    "startChar": 8,
    "endLine": 250,
    "content": "target_dir = sys.argv[1]",
    "references": []
  },
  {
    "filePath": "/Users/bong/workspace/my-rag-project/indexer/lsp_indexer.py",
    "symbolName": "indexer",
    "symbolKind": "Kind(13)",
    "startLine": 256,
    "startChar": 4,
    "endLine": 256,
    "content": "indexer = PyrightLSPClient(target_dir)",
    "references": []
  }
]